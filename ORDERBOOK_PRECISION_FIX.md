# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ –∫–æ–º–ø–∞–∫—Ç–Ω–æ—Å—Ç–∏ —Å—Ç–∞–∫–∞–Ω–∞ –æ—Ä–¥–µ—Ä–æ–≤

## –î–∞—Ç–∞: 6 –Ω–æ—è–±—Ä—è 2025

## –ü—Ä–æ–±–ª–µ–º–∞
1. **–ú–∞–ª–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤** - –Ω–µ –≤—Å–µ –∑–Ω–∞—á–∞—â–∏–µ —Ü–∏—Ñ—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞–ª–∏—Å—å –≤ —Å—Ç–∞–∫–∞–Ω–µ
2. **–ë–æ–ª—å—à–∏–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É —Å—Ç—Ä–æ–∫–∞–º–∏** - —Å—Ç–∞–∫–∞–Ω –∑–∞–Ω–∏–º–∞–ª —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –º–µ—Å—Ç–∞
3. **–ù–µ–ø–æ–ª–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–æ–≤** - quote –≤–∞–ª—é—Ç–∞ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç –≤ USD

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –£–ª—É—á—à–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–µ–Ω (formatPrice)

#### –§—É–Ω–∫—Ü–∏—è formatPrice
```javascript
function formatPrice(value) {
    const num = parseFloat(value);
    if (isNaN(num)) return '0';
    
    // –ï—Å–ª–∏ —á–∏—Å–ª–æ –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–æ–µ (< 0.0001), –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞—É—á–Ω—É—é –Ω–æ—Ç–∞—Ü–∏—é
    if (num < 0.0001 && num > 0) {
        return num.toExponential(4);
    }
    
    // –ï—Å–ª–∏ —á–∏—Å–ª–æ –±–æ–ª—å—à–æ–µ (> 1000), –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å –∑–∞–ø—è—Ç—ã–º–∏
    if (num >= 1000) {
        return num.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 8});
    }
    
    // –î–ª—è –æ–±—ã—á–Ω—ã—Ö —á–∏—Å–µ–ª - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ –∑–Ω–∞—á–∞—â–∏–µ —Ü–∏—Ñ—Ä—ã (–¥–æ 8 –∑–Ω–∞–∫–æ–≤)
    // –£–±–∏—Ä–∞–µ–º trailing zeros
    return num.toFixed(8).replace(/\.?0+$/, '');
}
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
- –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–∞–∫–∞–Ω–µ (—Ü–µ–Ω–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, —Å—É–º–º–∞) –∏—Å–ø–æ–ª—å–∑—É—é—Ç `formatPrice`
- –°–ø—Ä–µ–¥ —Ç–∞–∫–∂–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `formatPrice`
- –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤—Å–µ –∑–Ω–∞—á–∞—â–∏–µ —Ü–∏—Ñ—Ä—ã, –Ω–æ –±–µ–∑ –ª–∏—à–Ω–∏—Ö –Ω—É–ª–µ–π

### 2. –ö–æ–º–ø–∞–∫—Ç–Ω–æ—Å—Ç—å —Å—Ç–∞–∫–∞–Ω–∞

#### CSS –∏–∑–º–µ–Ω–µ–Ω–∏—è:

**–°—Ç—Ä–æ–∫–∏ —Å—Ç–∞–∫–∞–Ω–∞:**
```css
.orderbook-row {
    padding: 2px 5px;  /* –±—ã–ª–æ: 5px */
    line-height: 1.3;  /* –¥–æ–±–∞–≤–ª–µ–Ω–æ –¥–ª—è —É–ø–ª–æ—Ç–Ω–µ–Ω–∏—è */
}
```

**–ó–∞–≥–æ–ª–æ–≤–æ–∫:**
```css
.orderbook-header {
    padding: 6px 5px;  /* –±—ã–ª–æ: 8px 5px */
}
```

**–°–ø—Ä–µ–¥:**
```css
.orderbook-spread {
    padding: 6px 5px;  /* –±—ã–ª–æ: 10px 5px */
}
```

**–í—ã—Å–æ—Ç–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:**
```css
.orderbook-asks, .orderbook-bids {
    max-height: 250px;  /* –±—ã–ª–æ: 200px */
}
```

### 3. –£–ª—É—á—à–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–æ–≤

#### Frontend (index.html)
- –î–æ–±–∞–≤–ª–µ–Ω `id="quoteBalanceUSD"` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–∞ quote –≤–∞–ª—é—Ç—ã
- –§—É–Ω–∫—Ü–∏—è `loadPairBalances` –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–±–æ–∏—Ö —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–æ–≤

#### Backend (mTrade.py)
**–ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –≤ `/api/pair/balances`:**
```python
# –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç base –≤–∞–ª—é—Ç—ã
base_available = float(base_balance['available'])
base_equivalent = base_available * current_price if current_price > 0 else 0

# –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç quote –≤–∞–ª—é—Ç—ã
quote_available = float(quote_balance['available'])
quote_equivalent = quote_available

# –ï—Å–ª–∏ quote –≤–∞–ª—é—Ç–∞ –Ω–µ USDT, –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –µ–µ –∫—É—Ä—Å –∫ USDT
if quote_currency.upper() != 'USDT':
    usdt_pair = f"{quote_currency}_USDT"
    usdt_data = ws_manager.get_data(usdt_pair) if ws_manager else None
    if usdt_data and usdt_data.get('ticker') and usdt_data['ticker'].get('last'):
        quote_price = float(usdt_data['ticker']['last'])
        quote_equivalent = quote_available * quote_price
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ:**
```python
return jsonify({
    "success": True,
    "balances": {
        "base": base_balance,
        "quote": quote_balance
    },
    "price": current_price,
    "base_equivalent": base_equivalent,
    "quote_equivalent": quote_equivalent  # –Ω–æ–≤–æ–µ –ø–æ–ª–µ
})
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π:
- –¶–µ–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é (4 –∑–Ω–∞–∫–∞)
- –ë–æ–ª—å—à–∏–µ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã
- Quote –±–∞–ª–∞–Ω—Å –±–µ–∑ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–∞ –≤ USD
- –°–ø—Ä–µ–¥ —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é

### –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:
- ‚úÖ –í—Å–µ –∑–Ω–∞—á–∞—â–∏–µ —Ü–∏—Ñ—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è (–¥–æ 8 –∑–Ω–∞–∫–æ–≤)
- ‚úÖ –ö–æ–º–ø–∞–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ (padding: 2px –≤–º–µ—Å—Ç–æ 5px)
- ‚úÖ –ë–æ–ª—å—à–µ —Å—Ç—Ä–æ–∫ –≤–∏–¥–Ω–æ (–≤—ã—Å–æ—Ç–∞ 250px –≤–º–µ—Å—Ç–æ 200px)
- ‚úÖ –û–±–∞ –±–∞–ª–∞–Ω—Å–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç –≤ USD
- ‚úÖ –°–ø—Ä–µ–¥ —Å –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—É—á–Ω–∞—è –Ω–æ—Ç–∞—Ü–∏—è –¥–ª—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —á–∏—Å–µ–ª
- ‚úÖ –£–±—Ä–∞–Ω—ã –ª–∏—à–Ω–∏–µ trailing zeros

## –ü—Ä–∏–º–µ—Ä—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

| –ó–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ä–æ–µ | –ù–æ–≤–æ–µ |
|----------|--------|-------|
| 0.00012345 | 0.0001 | 0.00012345 |
| 1234.56789 | 1234.5679 | 1,234.5679 |
| 0.00000001 | 0.0000 | 1.0000e-8 |
| 100.50000000 | 100.5000 | 100.5 |

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

1. **templates/index.html**
   - CSS: `.orderbook-row`, `.orderbook-header`, `.orderbook-spread`, `.orderbook-asks/.orderbook-bids`
   - HTML: –¥–æ–±–∞–≤–ª–µ–Ω `id="quoteBalanceUSD"`
   - JS: —Ñ—É–Ω–∫—Ü–∏—è `updateOrderBook` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `formatPrice` –¥–ª—è –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π
   - JS: —Ñ—É–Ω–∫—Ü–∏—è `loadPairBalances` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ `quote_equivalent`

2. **mTrade.py**
   - Endpoint `/api/pair/balances` - —Ä–∞—Å—á–µ—Ç `quote_equivalent`

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
1. –û—Ç–∫—Ä—ã—Ç—å http://localhost:5000
2. –í—ã–±—Ä–∞—Ç—å –≤–∞–ª—é—Ç–Ω—É—é –ø–∞—Ä—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, WLD_USDT)
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
   - –í—Å–µ —Ü–µ–Ω—ã –≤ —Å—Ç–∞–∫–∞–Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø–æ–ª–Ω—É—é —Ç–æ—á–Ω–æ—Å—Ç—å
   - –°—Ç—Ä–æ–∫–∏ –∫–æ–º–ø–∞–∫—Ç–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã
   - –û–±–∞ –±–∞–ª–∞–Ω—Å–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç –≤ USD
   - –°–ø—Ä–µ–¥ –ø–æ–∫–∞–∑–∞–Ω —Å –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é
   - –ù–µ—Ç –ª–∏—à–Ω–∏—Ö –Ω—É–ª–µ–π –≤ –∫–æ–Ω—Ü–µ —á–∏—Å–µ–ª

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

- ‚úÖ –¢–æ—á–Ω–æ—Å—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤
- ‚úÖ –ö–æ–º–ø–∞–∫—Ç–Ω–æ—Å—Ç—å —Å—Ç–∞–∫–∞–Ω–∞
- ‚úÖ –≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç—ã –±–∞–ª–∞–Ω—Å–æ–≤
- üîÑ (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≥–ª—É–±–∏–Ω—ã —Å—Ç–∞–∫–∞–Ω–∞
- üîÑ (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω
- üîÑ (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ó–≤—É–∫–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ª—É—á—à–∏—Ö —Ü–µ–Ω
