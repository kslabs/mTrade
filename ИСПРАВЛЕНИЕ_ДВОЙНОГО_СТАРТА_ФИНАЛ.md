# üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –î–≤–æ–π–Ω–æ–π —Å—Ç–∞—Ä—Ç –ø–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏

## –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏ –≤–∞–ª—é—Ç—ã –∞–≤—Ç–æ—Ç—Ä–µ–π–¥–µ—Ä —Å—Ä–∞–∑—É –Ω–∞—á–∏–Ω–∞–ª –Ω–æ–≤—ã–π —Ü–∏–∫–ª, –Ω–µ –¥–æ–∂–∏–¥–∞—è—Å—å 60-—Å–µ–∫—É–Ω–¥–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –¥–≤–æ–π–Ω—ã–º –ø–æ–∫—É–ø–∫–∞–º.

### –ü—Ä–∏–º–µ—Ä –∏–∑ –ª–æ–≥–æ–≤:
```
15:31:28 - –ü—Ä–æ–¥–∞–∂–∞ XRP
15:31:45 - –ü–æ–∫—É–ø–∫–∞ XRP (—á–µ—Ä–µ–∑ 17 —Å–µ–∫—É–Ω–¥!)
15:33:14 - –ï—â—ë –æ–¥–Ω–∞ –ø–æ–∫—É–ø–∫–∞ XRP (–µ—â—ë —á–µ—Ä–µ–∑ 89 —Å–µ–∫—É–Ω–¥)
```

## –ü—Ä–∏—á–∏–Ω–∞
**–í —Ñ—É–Ω–∫—Ü–∏–∏ `_try_sell` –ø–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏ –ù–ï —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–æ—Å—å –ø–æ–ª–µ `last_sell_at`**, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ `_try_start_cycle` –¥–ª—è –∑–∞–¥–µ—Ä–∂–∫–∏ 60 —Å–µ–∫—É–Ω–¥.

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ—à–∏–±–∫–∏:
1. –ü—Ä–æ–¥–∞–∂–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ ‚Üí –≤—ã–∑–≤–∞–Ω `cycle.reset()`
2. –ú–µ—Ç–æ–¥ `reset()` –ù–ï —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `last_sell_at = time.time()`
3. –í `_try_start_cycle` –ø—Ä–æ–≤–µ—Ä–∫–∞ `if cycle.last_sell_at > 0` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç False (—Ç.–∫. `last_sell_at = 0.0`)
4. –ó–∞–¥–µ—Ä–∂–∫–∞ 60 —Å–µ–∫—É–Ω–¥ –ù–ï –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è
5. –ê–≤—Ç–æ—Ç—Ä–µ–π–¥–µ—Ä —Å—Ä–∞–∑—É –Ω–∞—á–∏–Ω–∞–µ—Ç –Ω–æ–≤—ã–π —Ü–∏–∫–ª ‚Üí **–î–í–û–ô–ù–û–ô –°–¢–ê–†–¢**

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### 1. –í —Ñ—É–Ω–∫—Ü–∏–∏ `_try_sell` (—Å—Ç—Ä–æ–∫–∞ ~1115):
```python
# –®–ê–ì 5: –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ü–∏–∫–ª –≤ IDLE (–ø–æ–¥ lock, –±—ã—Å—Ç—Ä–æ!)
with lock:
    cycle = self.cycles[base]
    # üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Ä–µ–º—è –ø—Ä–æ–¥–∞–∂–∏ –î–û —Å–±—Ä–æ—Å–∞!
    cycle.last_sell_at = time.time()
    print(f"[{base}] ‚è∞ –í—Ä–µ–º—è –ø—Ä–æ–¥–∞–∂–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ: {cycle.last_sell_at}")
    cycle.reset()
    print(f"[{base}] –¶–∏–∫–ª —Å–±—Ä–æ—à–µ–Ω –≤ IDLE –ø–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏")
    self._save_state(base)
```

### 2. –í –º–µ—Ç–æ–¥–µ `reset()` (—Å—Ç—Ä–æ–∫–∞ ~87):
```python
# üî¥ –í–ê–ñ–ù–û: last_sell_at –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞–µ–º - –æ–Ω –Ω—É–∂–µ–Ω –¥–ª—è –∑–∞–¥–µ—Ä–∂–∫–∏ –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º —Ü–∏–∫–ª–æ–º!
```

### 3. –í —Ñ—É–Ω–∫—Ü–∏–∏ `_try_start_cycle` (—Å—Ç—Ä–æ–∫–∞ ~684):
```python
# –ù–û–í–ê–Ø –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏ (60 —Å–µ–∫—É–Ω–¥)
if hasattr(cycle, 'last_sell_at') and cycle.last_sell_at > 0:
    time_since_sell = time.time() - cycle.last_sell_at
    if time_since_sell < 60:
        print(f"[{base}] ‚è∏Ô∏è [SKIP] –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏ ({time_since_sell:.1f}s < 60s)")
        return
    else:
        # –ó–∞–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ—à–ª–∞ - —Å–±—Ä–∞—Å—ã–≤–∞–µ–º last_sell_at
        print(f"[{base}] ‚úÖ –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏ –∏—Å—Ç–µ–∫–ª–∞ ({time_since_sell:.1f}s >= 60s), —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã–π —Ü–∏–∫–ª")
        cycle.last_sell_at = 0.0
```

## –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ü–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏:
1. ‚úÖ `last_sell_at = time.time()` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è **–î–û** `reset()`
2. ‚úÖ –¶–∏–∫–ª —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤ IDLE
3. ‚úÖ –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

### –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –Ω–æ–≤–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞:
1. –ü—Ä–æ–≤–µ—Ä–∫–∞: `time.time() - last_sell_at < 60` ?
   - **–î–ê** ‚Üí –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å—Ç–∞—Ä—Ç–∞, –ª–æ–≥: "–ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏ (X.Xs < 60s)"
   - **–ù–ï–¢** ‚Üí –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —Å—Ç–∞—Ä—Ç, –ª–æ–≥: "–ó–∞–¥–µ—Ä–∂–∫–∞ –∏—Å—Ç–µ–∫–ª–∞ (X.Xs >= 60s)"
2. –ü–æ—Å–ª–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏: `last_sell_at = 0.0` (—Å–±—Ä–æ—Å –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ü–∏–∫–ª–∞)

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ –º–æ–Ω–µ—Ç —á–µ—Ä–µ–∑ `_check_and_reset_if_empty()` –ø–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º
- –§–ª–∞–≥ `_buying_in_progress` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
```
15:31:28 - –ü—Ä–æ–¥–∞–∂–∞ XRP ‚Üí last_sell_at —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
15:31:30 - –ü–æ–ø—ã—Ç–∫–∞ —Å—Ç–∞—Ä—Ç–∞ ‚Üí –ë–õ–û–ö–ò–†–û–í–ö–ê (–ø—Ä–æ—à–ª–æ 2s < 60s)
15:31:45 - –ü–æ–ø—ã—Ç–∫–∞ —Å—Ç–∞—Ä—Ç–∞ ‚Üí –ë–õ–û–ö–ò–†–û–í–ö–ê (–ø—Ä–æ—à–ª–æ 17s < 60s)
15:32:29 - –ü–æ–ø—ã—Ç–∫–∞ —Å—Ç–∞—Ä—Ç–∞ ‚Üí –†–ê–ó–†–ï–®–ï–ù–ò–ï (–ø—Ä–æ—à–ª–æ 61s >= 60s)
15:32:29 - –ù–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞ XRP
```

## –°—Ç–∞—Ç—É—Å
‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
- –ö–æ–¥ –æ–±–Ω–æ–≤–ª—ë–Ω
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ
- –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

## –î–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
1. **–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä** (Ctrl+C)
2. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ**: `python mTrade.py`
3. **–ù–∞–±–ª—é–¥–∞—Ç—å –ª–æ–≥–∏** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π:
   - `‚è∞ –í—Ä–µ–º—è –ø—Ä–æ–¥–∞–∂–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ`
   - `‚è∏Ô∏è [SKIP] –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏ (X.Xs < 60s)`
   - `‚úÖ –ó–∞–¥–µ—Ä–∂–∫–∞ –∏—Å—Ç–µ–∫–ª–∞ (X.Xs >= 60s), —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã–π —Ü–∏–∫–ª`

## –§–∞–π–ª –∏–∑–º–µ–Ω—ë–Ω
- `autotrader_v2.py` (—Å—Ç—Ä–æ–∫–∏ 87, 684-691, 1115-1122)

---
**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 8 –¥–µ–∫–∞–±—Ä—è 2024, 16:00  
**–í–µ—Ä—Å–∏—è –∫–æ–¥–∞:** 2024-12-08_16:00
