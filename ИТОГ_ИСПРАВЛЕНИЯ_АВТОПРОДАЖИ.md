# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ó–ê–í–ï–†–®–ï–ù–´ - –ê–í–¢–û–ü–†–û–î–ê–ñ–ê –û–°–¢–ê–¢–ö–û–í –†–ê–ë–û–¢–ê–ï–¢

## üéØ –ó–ê–î–ê–ß–ê
–ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `_try_sell_idle_balance`, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–ª–∂–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–¥–∞–≤–∞—Ç—å –æ—Å—Ç–∞—Ç–∫–∏ –º–æ–Ω–µ—Ç –≤ IDLE —Å–æ—Å—Ç–æ—è–Ω–∏–∏.

---

## ‚ùå –ù–ê–ô–î–ï–ù–ù–´–ï –û–®–ò–ë–ö–ò

### 1. –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥ `api_client.get_balance(base)`
```python
# ‚ùå –ë–´–õ–û (–ù–ï –†–ê–ë–û–¢–ê–õ–û):
balance_info = api_client.get_balance(base)
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ—Ç–æ–¥ `get_balance()` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ API –∫–ª–∏–µ–Ω—Ç–µ –±–∏—Ä–∂–∏.

### 2. –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥ `self._reset_cycle(base, quote)`
```python
# ‚ùå –ë–´–õ–û (–ù–ï –†–ê–ë–û–¢–ê–õ–û):
self._reset_cycle(base, quote)
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ—Ç–æ–¥ `_reset_cycle()` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –∫–ª–∞—Å—Å–µ `AutoTraderV2`.

---

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ (—Å—Ç—Ä–æ–∫–∞ ~1147)
```python
# ‚úÖ –°–¢–ê–õ–û (–†–ê–ë–û–¢–ê–ï–¢):
all_balances = api_client.get_account_balance()
balance_info = next((b for b in all_balances if b.get('currency') == base), None)
```

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –º–µ—Ç–æ–¥ `get_account_balance()`, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –±–∞–ª–∞–Ω—Å–æ–≤, –∏ —Ñ–∏–ª—å—Ç—Ä—É–µ–º –Ω—É–∂–Ω—É—é –≤–∞–ª—é—Ç—É.

### 2. –°–±—Ä–æ—Å —Ü–∏–∫–ª–∞ (—Å—Ç—Ä–æ–∫–∏ ~1177, 1185, 1203, 1209, 1215)
```python
# ‚úÖ –°–¢–ê–õ–û (–†–ê–ë–û–¢–ê–ï–¢):
with self.locks[base]:
    if base in self.cycles:
        self.cycles[base].reset(manual=False)
        print(f"[{base}] ‚úÖ –¶–∏–∫–ª —Å–±—Ä–æ—à–µ–Ω")
```

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç–æ–¥ `reset()` –æ–±—ä–µ–∫—Ç–∞ `TradingCycle`, –∫–æ—Ç–æ—Ä—ã–π —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ü–∏–∫–ª–∞.

---

## üìä –ö–û–õ–ò–ß–ï–°–¢–í–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

| –ú–µ—Å—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | –°—Ç—Ä–æ–∫–∞ |
|-------------------|----------------|--------|
| –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ | `get_balance()` ‚Üí `get_account_balance()` | ~1147 |
| –°–±—Ä–æ—Å –ø—Ä–∏ –º–∞–ª–æ–º –æ–±—ä—ë–º–µ (base) | `_reset_cycle()` ‚Üí `cycles[base].reset()` | ~1177 |
| –°–±—Ä–æ—Å –ø—Ä–∏ –º–∞–ª–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏ (quote) | `_reset_cycle()` ‚Üí `cycles[base].reset()` | ~1185 |
| –°–±—Ä–æ—Å –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–¥–∞–∂–∏ | `_reset_cycle()` ‚Üí `cycles[base].reset()` | ~1203 |
| –°–±—Ä–æ—Å –ø–æ—Å–ª–µ –Ω–µ—É–¥–∞—á–Ω–æ–π –ø—Ä–æ–¥–∞–∂–∏ | `_reset_cycle()` ‚Üí `cycles[base].reset()` | ~1209 |
| –°–±—Ä–æ—Å –ø—Ä–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–∏ | `_reset_cycle()` ‚Üí `cycles[base].reset()` | ~1215 |

**–ò–¢–û–ì–û:** 6 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –≤ 1 —Ñ—É–Ω–∫—Ü–∏–∏

---

## üîç –ü–†–û–í–ï–†–ö–ê

### –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
```bash
get_errors("autotrader_v2.py")
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ **No errors found**

### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
- ‚úÖ –ë–∞–ª–∞–Ω—Å –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –¶–∏–∫–ª —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ (`with self.locks[base]`)
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –≤—Å–µ—Ö —ç—Ç–∞–ø–∞—Ö

---

## üöÄ –ö–ê–ö –†–ê–ë–û–¢–ê–ï–¢ –¢–ï–ü–ï–†–¨

### –ê–ª–≥–æ—Ä–∏—Ç–º –∞–≤—Ç–æ–ø—Ä–æ–¥–∞–∂–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤:

```
1. –ë–æ—Ç –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –æ—Å—Ç–∞—Ç–∫–∏ –º–æ–Ω–µ—Ç—ã –≤ IDLE —Å–æ—Å—Ç–æ—è–Ω–∏–∏
   ‚Üì
2. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è _try_sell_idle_balance
   ‚Üì
3. –ü–æ–ª—É—á–∞–µ—Ç –±–∞–ª–∞–Ω—Å —á–µ—Ä–µ–∑ get_account_balance()
   ‚Üì
4. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ (min_base_amount, min_quote_amount)
   ‚Üì
5a. –ï—Å–ª–∏ –æ—Å—Ç–∞—Ç–∫–∏ >= –º–∏–Ω–∏–º—É–º–∞:
    - –°–æ–∑–¥–∞—ë—Ç –æ—Ä–¥–µ—Ä –Ω–∞ –ø—Ä–æ–¥–∞–∂—É
    - –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ü–∏–∫–ª –ø–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏
    - ‚úÖ –¶–∏–∫–ª –º–æ–∂–µ—Ç —Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å –∑–∞–Ω–æ–≤–æ
   ‚Üì
5b. –ï—Å–ª–∏ –æ—Å—Ç–∞—Ç–∫–∏ < –º–∏–Ω–∏–º—É–º–∞:
    - –ù–ï —Å–æ–∑–¥–∞—ë—Ç –æ—Ä–¥–µ—Ä (—Å–ª–∏—à–∫–æ–º –º–∞–ª—ã)
    - –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ü–∏–∫–ª –ë–ï–ó –ø—Ä–æ–¥–∞–∂–∏
    - ‚úÖ –¶–∏–∫–ª –º–æ–∂–µ—Ç —Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å –∑–∞–Ω–æ–≤–æ
   ‚Üì
5c. –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ API:
    - –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ü–∏–∫–ª –¥–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
    - ‚úÖ –¶–∏–∫–ª –º–æ–∂–µ—Ç —Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å –∑–∞–Ω–æ–≤–æ
```

---

## üìã –°–û–ó–î–ê–ù–ù–´–ï –§–ê–ô–õ–´

1. **–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï_–ê–í–¢–û–ü–†–û–î–ê–ñ–ò_–û–°–¢–ê–¢–ö–û–í_–§–ò–ù–ê–õ.md** - –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
2. **–ë–´–°–¢–†–û–ï_–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï_–ê–í–¢–û–ü–†–û–î–ê–ñ–ò.md** - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
3. **–ò–¢–û–ì_–ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø_–ê–í–¢–û–ü–†–û–î–ê–ñ–ò.md** - —ç—Ç–æ—Ç —Ñ–∞–π–ª (–∏—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞)

---

## üéØ –ß–¢–û –î–ê–õ–¨–®–ï

### 1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
python autotrader_v2.py
```

–°–æ–∑–¥–∞—Ç—å –æ—Å—Ç–∞—Ç–∫–∏ DOGE (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—Ä—É—á–Ω—É—é –∫—É–ø–∏—Ç—å) –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏.

### 2. –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏ (—É—Å–ø–µ—à–Ω–∞—è –ø—Ä–æ–¥–∞–∂–∞):
```
[DOGE] üîÑ === –ê–í–¢–û–ü–†–û–î–ê–ñ–ê –û–°–¢–ê–¢–ö–û–í –í IDLE –°–û–°–¢–û–Ø–ù–ò–ò ===
[DOGE] üí∞ –î–æ—Å—Ç—É–ø–Ω—ã–π –±–∞–ª–∞–Ω—Å –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏: 15.50000000
[DOGE] üìä –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞—Ä—ã: min_base=10.0, min_quote=1.0
[DOGE] üöÄ –°–æ–∑–¥–∞–µ–º –æ—Ä–¥–µ—Ä –Ω–∞ –ø—Ä–æ–¥–∞–∂—É –æ—Å—Ç–∞—Ç–∫–æ–≤:
[DOGE] üöÄ   –û–±—ä–µ–º: 15.5 DOGE
[DOGE] üöÄ   –¶–µ–Ω–∞: 0.31245000 USDT
[DOGE] ‚úÖ –û—Ä–¥–µ—Ä —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ: 123456789
[DOGE] ‚úÖ –¶–∏–∫–ª —Å–±—Ä–æ—à–µ–Ω –ø–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤
```

### 3. –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏ (—Å–±—Ä–æ—Å –±–µ–∑ –ø—Ä–æ–¥–∞–∂–∏):
```
[DOGE] üîÑ === –ê–í–¢–û–ü–†–û–î–ê–ñ–ê –û–°–¢–ê–¢–ö–û–í –í IDLE –°–û–°–¢–û–Ø–ù–ò–ò ===
[DOGE] üí∞ –î–æ—Å—Ç—É–ø–Ω—ã–π –±–∞–ª–∞–Ω—Å –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏: 0.50000000
[DOGE] üìä –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞—Ä—ã: min_base=10.0, min_quote=1.0
[DOGE] ‚ö†Ô∏è –û–±—ä–µ–º 0.5 –º–µ–Ω—å—à–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ 10.0
[DOGE] üóëÔ∏è –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ü–∏–∫–ª, –æ—Å—Ç–∞—Ç–∫–∏ —Å–ª–∏—à–∫–æ–º –º–∞–ª—ã –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏
[DOGE] ‚úÖ –¶–∏–∫–ª —Å–±—Ä–æ—à–µ–Ω, –æ—Å—Ç–∞—Ç–∫–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è
```

---

## ‚úÖ –ö–†–ò–¢–ï–†–ò–ò –£–°–ü–ï–•–ê

–¢–µ—Å—Ç —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–º, –µ—Å–ª–∏:

1. ‚úÖ –ë–æ—Ç –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –æ—Å—Ç–∞—Ç–∫–∏ –≤ IDLE
2. ‚úÖ –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `_try_sell_idle_balance`
3. ‚úÖ –ë–∞–ª–∞–Ω—Å –ø–æ–ª—É—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `get_account_balance()`
4. ‚úÖ –û—Ä–¥–µ—Ä —Å–æ–∑–¥–∞—ë—Ç—Å—è –ò–õ–ò —Ü–∏–∫–ª —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è (–µ—Å–ª–∏ –æ—Å—Ç–∞—Ç–∫–∏ –º–∞–ª—ã)
5. ‚úÖ –¶–∏–∫–ª —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `self.cycles[base].reset()`
6. ‚úÖ –ù–∏–∫–∞–∫–∏—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π –≤ –ª–æ–≥–∞—Ö
7. ‚úÖ –¶–∏–∫–ª –º–æ–∂–µ—Ç —Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å –∑–∞–Ω–æ–≤–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## üèÜ –ò–¢–û–ì

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å –¥–æ | –°—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ |
|-----------|-----------|--------------|
| –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ | ‚ùå `get_balance()` (–Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç) | ‚úÖ `get_account_balance()` |
| –°–±—Ä–æ—Å —Ü–∏–∫–ª–∞ | ‚ùå `_reset_cycle()` (–Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç) | ‚úÖ `cycles[base].reset()` |
| –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ | ‚ùå –ï—Å—Ç—å | ‚úÖ –ù–µ—Ç |
| –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | ‚ö†Ô∏è –ù–µ—Ç | ‚úÖ –ï—Å—Ç—å (`with locks`) |
| –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ–µ | ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ |
| –ê–≤—Ç–æ–ø—Ä–æ–¥–∞–∂–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ | ‚ùå –ù–ï –†–ê–ë–û–¢–ê–õ–ê | ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢** |

---

**–î–ê–¢–ê:** 2025-01-XX  
**–§–ê–ô–õ:** autotrader_v2.py  
**–§–£–ù–ö–¶–ò–Ø:** `_try_sell_idle_balance`  
**–°–¢–ê–¢–£–°:** ‚úÖ **–ì–û–¢–û–í–û –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ**
