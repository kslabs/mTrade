# ‚úÖ –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –°—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Ü–∏–∫–ª–∞

> **–î–∞—Ç–∞:** 6 –¥–µ–∫–∞–±—Ä—è 2025  
> **–í–µ—Ä—Å–∏—è:** AutoTraderV2 - Phase 1  
> **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ

---

## üì¶ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### ‚úÖ **1. –ú–µ—Ç–æ–¥ `_try_start_cycle()`**
–ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Å—Ç–∞—Ä—Ç–æ–≤–æ–π –ø–æ–∫—É–ø–∫–∏:

```python
def _try_start_cycle(self, base: str, quote: str, cycle: TradingCycle, price: float):
    """
    –ê–õ–ì–û–†–ò–¢–ú (–ø–æ–¥ Lock!):
    1. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∏ —É—Å–ª–æ–≤–∏—è
    2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ BUY –æ—Ä–¥–µ—Ä–∞
    3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç—ã
    4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å –∫–æ—Ç–∏—Ä—É–µ–º–æ–π –≤–∞–ª—é—Ç—ã (USDT)
    5. ‚úÖ –°–æ–∑–¥–∞—Ç—å MARKET –æ—Ä–¥–µ—Ä –Ω–∞ –ø–æ–∫—É–ø–∫—É
    6. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ
    7. ‚úÖ –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Ü–∏–∫–ª
    """
```

### ‚úÖ **2. –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–µ–π**
- ‚úÖ **Lock –Ω–∞ –≤–∞–ª—é—Ç—É** - –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∞—Ç–æ–º–∞—Ä–Ω—ã
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤** - –ø—Ä–æ–ø—É—Å–∫, –µ—Å–ª–∏ –µ—Å—Ç—å BUY –æ—Ä–¥–µ—Ä
- ‚úÖ **–§–ª–∞–≥ `_buying_in_progress`** - –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤—Ö–æ–¥–∞
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ü–∏–∫–ª–∞** - —Ç–æ–ª—å–∫–æ –¥–ª—è IDLE

### ‚úÖ **3. –†–µ–∂–∏–º –ø—Ä–æ–¥–∞–∂–∏ –±–µ–∑ –ø–æ–∫—É–ø–∫–∏**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç—ã
- ‚úÖ –ê–∫—Ç–∏–≤–∞—Ü–∏—è —Ü–∏–∫–ª–∞ –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ä–¥–µ—Ä–∞
- ‚úÖ –†–∞—Å—á—ë—Ç —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–∞ –≤ USD

### ‚úÖ **4. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –≠–º–æ–¥–∑–∏-–º–∞—Ä–∫–µ—Ä—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö —Å traceback

### ‚úÖ **5. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**
- ‚úÖ –°—á—ë—Ç—á–∏–∫–∏ —Ü–∏–∫–ª–æ–≤ –∏ –æ—Ä–¥–µ—Ä–æ–≤
- ‚úÖ API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –æ—Ä–¥–µ—Ä–æ–≤ –≤ —Ü–∏–∫–ª–µ

---

## üìÇ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### ‚úÖ **autotrader_v2.py**
```
–î–æ–±–∞–≤–ª–µ–Ω–æ:
+ _try_start_cycle()        - –ú–µ—Ç–æ–¥ —Å—Ç–∞—Ä—Ç–æ–≤–æ–π –ø–æ–∫—É–ø–∫–∏
+ get_stats()               - API —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
+ orders_history            - –ò—Å—Ç–æ—Ä–∏—è –æ—Ä–¥–µ—Ä–æ–≤ –≤ —Ü–∏–∫–ª–µ
+ _buying_in_progress       - –§–ª–∞–≥ –∑–∞—â–∏—Ç—ã –æ—Ç –¥—É–±–ª–µ–π

–ò–∑–º–µ–Ω–µ–Ω–æ:
~ _main_loop()              - –í—ã–∑–æ–≤ _try_start_cycle()
```

### ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
```
–°–æ–∑–¥–∞–Ω–æ:
+ START_CYCLE_ALGORITHM.md   - –ü–æ–ª–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º (43 –ö–ë)
+ START_CYCLE_TESTING.md     - –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (15 –ö–ë)
+ QUICK_TEST_GUIDE.md        - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (3 –ö–ë)
+ START_CYCLE_STATUS.md      - –¢–µ–∫—É—â–∏–π —Ñ–∞–π–ª
```

---

## üî¨ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞

```bash
python -m py_compile autotrader_v2.py
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ **–£—Å–ø–µ—à–Ω–æ** (–Ω–µ—Ç –æ—à–∏–±–æ–∫)

---

## üß™ –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ **6 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤**:

1. ‚úÖ **–ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞**
   - –°–æ–∑–¥–∞–Ω–∏–µ MARKET –æ—Ä–¥–µ—Ä–∞
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
   - –ê–∫—Ç–∏–≤–∞—Ü–∏—è —Ü–∏–∫–ª–∞

2. ‚úÖ **–ú–æ–Ω–µ—Ç—ã —É–∂–µ –µ—Å—Ç—å (—Ä–µ–∂–∏–º –ø—Ä–æ–¥–∞–∂–∏)**
   - –ü—Ä–æ–ø—É—Å–∫ —Å—Ç–∞—Ä—Ç–æ–≤–æ–π –ø–æ–∫—É–ø–∫–∏
   - –ê–∫—Ç–∏–≤–∞—Ü–∏—è —Ü–∏–∫–ª–∞ —Å —Ç–µ–∫—É—â–∏–º –±–∞–ª–∞–Ω—Å–æ–º

3. ‚úÖ **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ USDT**
   - –ü—Ä–æ–ø—É—Å–∫ –æ–ø–µ—Ä–∞—Ü–∏–∏
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

4. ‚úÖ **–ï—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π BUY –æ—Ä–¥–µ—Ä**
   - –ü—Ä–æ–ø—É—Å–∫ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –æ—Ä–¥–µ—Ä–∞
   - –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ

5. ‚úÖ **–ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ –∞–≤—Ç–æ—Ç—Ä–µ–π–¥–µ—Ä–∞**
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ü–∏–∫–ª–∞
   - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥—É–±–ª–µ–π

6. ‚úÖ **–ù–µ—Å–∫–æ–ª—å–∫–æ –≤–∞–ª—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ**
   - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
   - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ race condition

---

## üìä –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞** | ~220 (–º–µ—Ç–æ–¥ `_try_start_cycle`) |
| **–ü—Ä–æ–≤–µ—Ä–æ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** | 6 |
| **–õ–æ–≥–æ–≤ –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—é** | ~15 |
| **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è** | ~1 —Å–µ–∫—É–Ω–¥–∞ |
| **–ó–∞—â–∏—Ç –æ—Ç –¥—É–±–ª–µ–π** | 4 —É—Ä–æ–≤–Ω—è |

---

## üéØ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

### ‚úÖ **–ö–æ–¥:**
- [x] –ú–µ—Ç–æ–¥ `_try_start_cycle()` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- [x] –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –†–µ–∂–∏–º –ø—Ä–æ–¥–∞–∂–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
- [x] –°–∏–Ω—Ç–∞–∫—Å–∏—Å –ø—Ä–æ–≤–µ—Ä–µ–Ω

### ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [x] –ê–ª–≥–æ—Ä–∏—Ç–º –æ–ø–∏—Å–∞–Ω (START_CYCLE_ALGORITHM.md)
- [x] –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≥–æ—Ç–æ–≤—ã (START_CYCLE_TESTING.md)
- [x] –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –Ω–∞–ø–∏—Å–∞–Ω (QUICK_TEST_GUIDE.md)
- [x] –°—Ç–∞—Ç—É—Å –æ—Ç—Ä–∞–∂—ë–Ω (START_CYCLE_STATUS.md)

### ‚è≥ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- [ ] –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–æ—Ä–º–∞–ª—å–Ω–∞—è –ø–æ–∫—É–ø–∫–∞
- [ ] –°—Ü–µ–Ω–∞—Ä–∏–π 2: –†–µ–∂–∏–º –ø—Ä–æ–¥–∞–∂–∏
- [ ] –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ USDT
- [ ] –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ê–∫—Ç–∏–≤–Ω—ã–π –æ—Ä–¥–µ—Ä
- [ ] –°—Ü–µ–Ω–∞—Ä–∏–π 5: –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫
- [ ] –°—Ü–µ–Ω–∞—Ä–∏–π 6: –ù–µ—Å–∫–æ–ª—å–∫–æ –≤–∞–ª—é—Ç

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### **–§–∞–∑–∞ 1: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** (—Å–µ–π—á–∞—Å)
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ 6 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
3. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏
4. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥—É–±–ª–µ–π

### **–§–∞–∑–∞ 2: –î–æ–∫—É–ø–∫–∏ (rebuy)**
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ `_try_rebuy()`
- –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –¥–æ–∫—É–ø–æ–∫ –ø–æ —Ç–∞–±–ª–∏—Ü–µ
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### **–§–∞–∑–∞ 3: –ü—Ä–æ–¥–∞–∂–∏ (sell)**
–ü–æ—Å–ª–µ –¥–æ–∫—É–ø–æ–∫:
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ `_try_sell()`
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —É—Å–ª–æ–≤–∏–π –ø—Ä–æ–¥–∞–∂–∏
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### **–í–∞–∂–Ω–æ:**
1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **—Ç–µ—Å—Ç–æ–≤—É—é —Å–µ—Ç—å** (network_mode = 'test')
2. –ò–º–µ—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –±–∞–ª–∞–Ω—Å USDT (–º–∏–Ω–∏–º—É–º 30 –¥–ª—è 3 –≤–∞–ª—é—Ç)
3. –í—Ä—É—á–Ω—É—é –ø—Ä–æ–¥–∞–≤–∞—Ç—å –º–æ–Ω–µ—Ç—ã –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤
4. –°–±—Ä–∞—Å—ã–≤–∞—Ç—å —Ü–∏–∫–ª—ã —á–µ—Ä–µ–∑ API –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤

### **–õ–æ–≥–∏:**
–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏:
- `üî•` –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ä–¥–µ—Ä–∞
- `‚úÖ` –£—Å–ø–µ—Ö
- `‚ö†Ô∏è` –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
- `‚ùå` –û—à–∏–±–∫–∞
- `‚è∏Ô∏è` –ü—Ä–æ–ø—É—Å–∫
- `üí∞` –ë–∞–ª–∞–Ω—Å
- `üîÑ` –ê–∫—Ç–∏–≤–∞—Ü–∏—è

### **API Endpoints:**
- `GET /api/autotrade/status` - –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å
- `GET /api/autotrader/stats?base_currency=BTC` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤–∞–ª—é—Ç–µ
- `POST /api/autotrader/reset_cycle` - –°–±—Ä–æ—Å —Ü–∏–∫–ª–∞

---

## ‚úÖ –ò—Ç–æ–≥

**–°—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Ü–∏–∫–ª–∞:** ‚úÖ **–ì–û–¢–û–í –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
- ‚úÖ –°–æ–∑–¥–∞—ë—Ç—Å—è **–†–û–í–ù–û –û–î–ò–ù** MARKET –æ—Ä–¥–µ—Ä –Ω–∞ –≤–∞–ª—é—Ç—É
- ‚úÖ –ù–µ—Ç –¥—É–±–ª–µ–π –¥–∞–∂–µ –ø—Ä–∏ –±—ã—Å—Ç—Ä–æ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
- ‚úÖ –†–µ–∂–∏–º –ø—Ä–æ–¥–∞–∂–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç, –µ—Å–ª–∏ –º–æ–Ω–µ—Ç—ã —É–∂–µ –µ—Å—Ç—å
- ‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–±–∞–ª–∞–Ω—Å, –æ—Ä–¥–µ—Ä–∞) –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- ‚úÖ –õ–æ–≥–∏ –ø–æ–Ω—è—Ç–Ω—ã –∏ –ø–æ–º–æ–≥–∞—é—Ç –≤ –æ—Ç–ª–∞–¥–∫–µ

---

**–ì–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É!** üöÄ  
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã –ø–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ `QUICK_TEST_GUIDE.md`
