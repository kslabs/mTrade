# âœ… Ð˜Ð¡ÐŸÐ ÐÐ’Ð›Ð•ÐÐ˜Ð•: Ð£Ð±Ñ€Ð°Ð½Ð° Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÐ° Ð¿Ð¾ÑÐ»Ðµ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð¸

## ðŸ“‹ Ð§Ñ‚Ð¾ Ð±Ñ‹Ð»Ð¾ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¾

### âŒ Ð£Ð´Ð°Ð»ÐµÐ½Ð¾: Ð—Ð°Ð´ÐµÑ€Ð¶ÐºÐ° 60 ÑÐµÐºÑƒÐ½Ð´ Ð¿Ð¾ÑÐ»Ðµ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð¸

**Ð‘Ñ‹Ð»Ð¾ (ÐÐ•ÐŸÐ ÐÐ’Ð˜Ð›Ð¬ÐÐž)**:
```python
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° 2: Ð—Ð°Ð´ÐµÑ€Ð¶ÐºÐ° Ð¿Ð¾ÑÐ»Ðµ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð¸ (60 ÑÐµÐºÑƒÐ½Ð´)
if hasattr(cycle, 'last_sell_at') and cycle.last_sell_at > 0:
    time_since_sell = time.time() - cycle.last_sell_at
    if time_since_sell < 60:
        print(f"[{base}] â¸ï¸ [SKIP] Ð—Ð°Ð´ÐµÑ€Ð¶ÐºÐ° Ð¿Ð¾ÑÐ»Ðµ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð¸ ({time_since_sell:.1f}s < 60s)")
        return
```

**Ð¡Ñ‚Ð°Ð»Ð¾ (ÐŸÐ ÐÐ’Ð˜Ð›Ð¬ÐÐž)**:
```python
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° 2: ÐŸÐ¾ÐºÑƒÐ¿ÐºÐ° ÑƒÐ¶Ðµ Ð² Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐµ?
if not hasattr(cycle, '_buying_in_progress'):
    ...
```

---

### âŒ Ð£Ð´Ð°Ð»ÐµÐ½Ð¾: Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° last_sell_at Ð¿Ð¾ÑÐ»Ðµ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð¸

**Ð‘Ñ‹Ð»Ð¾ (ÐÐ•ÐŸÐ ÐÐ’Ð˜Ð›Ð¬ÐÐž)**:
```python
# ðŸ”´ ÐšÐ Ð˜Ð¢Ð˜Ð§Ð•Ð¡ÐšÐ˜ Ð’ÐÐ–ÐÐž: Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ last_sell_at ÐŸÐ•Ð Ð•Ð” reset()!
cycle.last_sell_at = time.time()
print(f"[{base}] â° Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð° Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÐ° 60 ÑÐµÐº Ð¿ÐµÑ€ÐµÐ´ Ð½Ð¾Ð²Ñ‹Ð¼ Ñ†Ð¸ÐºÐ»Ð¾Ð¼")
```

**Ð¡Ñ‚Ð°Ð»Ð¾ (ÐŸÐ ÐÐ’Ð˜Ð›Ð¬ÐÐž)**:
```python
# Ð—Ð°ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ñ†Ð¸ÐºÐ» Ñ‡ÐµÑ€ÐµÐ· reset() - ÑÑ‚Ð¾ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ ÑÐ¿Ð¾ÑÐ¾Ð±!
cycle._selling_in_progress = False
cycle.reset(manual=False)
```

---

## âœ… Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚

**Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ñ‚Ð¾Ñ€Ð³Ð¾Ð²Ð»Ñ Ð¸Ð´Ñ‘Ñ‚ Ð‘Ð•Ð— Ð—ÐÐ”Ð•Ð Ð–Ð•Ðš:**
- âœ… ÐŸÐ¾ÑÐ»Ðµ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð¸ Ð½Ð¾Ð²Ñ‹Ð¹ Ñ†Ð¸ÐºÐ» Ð¼Ð¾Ð¶ÐµÑ‚ Ð½Ð°Ñ‡Ð°Ñ‚ÑŒÑÑ Ð¡Ð ÐÐ—Ð£
- âœ… ÐÐ¸ÐºÐ°ÐºÐ¸Ñ… Ð¸ÑÐºÑƒÑÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ñ… Ð¿Ð°ÑƒÐ· Ð¼ÐµÐ¶Ð´Ñƒ Ñ†Ð¸ÐºÐ»Ð°Ð¼Ð¸
- âœ… ÐœÐ°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð°Ñ ÑÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒ Ñ‚Ð¾Ñ€Ð³Ð¾Ð²Ñ‹Ñ… Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹

---

## ðŸŽ¯ Ð§Ñ‚Ð¾ ÑÑ‚Ð¾ Ð¾Ð·Ð½Ð°Ñ‡Ð°ÐµÑ‚

### Ð”Ð¾ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ:
```
[21:04:23] Sell (Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð°)
[21:04:23] â° Ð—Ð°Ð´ÐµÑ€Ð¶ÐºÐ° 60 ÑÐµÐº
...
[21:05:23] Buy (Ð½Ð¾Ð²Ð°Ñ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ° Ñ‡ÐµÑ€ÐµÐ· 60 ÑÐµÐº)
```

### ÐŸÐ¾ÑÐ»Ðµ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ:
```
[21:04:23] Sell (Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð°)
[21:04:24] Buy (Ð½Ð¾Ð²Ð°Ñ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ° Ð¡Ð ÐÐ—Ð£, ÐµÑÐ»Ð¸ ÑƒÑÐ»Ð¾Ð²Ð¸Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ñ‹)
```

---

## ðŸ“Š Ð—Ð°Ñ‰Ð¸Ñ‚Ñ‹, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ ÐžÐ¡Ð¢ÐÐ›Ð˜Ð¡Ð¬

Ð£Ð´Ð°Ð»ÐµÐ½Ð° Ñ‚Ð¾Ð»ÑŒÐºÐ¾ **Ð¸ÑÐºÑƒÑÑÑ‚Ð²ÐµÐ½Ð½Ð°Ñ Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÐ° 60 ÑÐµÐºÑƒÐ½Ð´**.

**ÐžÑÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð·Ð°Ñ‰Ð¸Ñ‚Ñ‹ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÑŽÑ‚:**
1. âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð±Ð°Ð»Ð°Ð½ÑÐ° Ð¿ÐµÑ€ÐµÐ´ Ð½Ð¾Ð²Ñ‹Ð¼ Ñ†Ð¸ÐºÐ»Ð¾Ð¼ (`_check_and_reset_if_empty`)
2. âœ… Ð¤Ð»Ð°Ð³ `_buying_in_progress` (Ð·Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ Ð´ÑƒÐ±Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ)
3. âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ñ‹Ñ… Ð¾Ñ€Ð´ÐµÑ€Ð¾Ð²
4. âœ… Lock Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´Ð¾Ñ‚Ð²Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ñ race condition

---

## ðŸš€ Ð§Ñ‚Ð¾ Ð´ÐµÐ»Ð°Ñ‚ÑŒ

1. **ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€** (Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ñ€Ð¸Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ)
2. **Ð”Ð¾Ð¶Ð´Ð¸Ñ‚ÐµÑÑŒ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð¸** â€” Ð½Ð¾Ð²Ñ‹Ð¹ Ñ†Ð¸ÐºÐ» Ð½Ð°Ñ‡Ð½Ñ‘Ñ‚ÑÑ Ð¡Ð ÐÐ—Ð£ Ð¿Ð¾ÑÐ»Ðµ Ð½ÐµÑ‘
3. **ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ, Ñ‡Ñ‚Ð¾ Ñ‚Ð¾Ñ€Ð³Ð¾Ð²Ð»Ñ Ð¸Ð´Ñ‘Ñ‚ Ð½ÐµÐ¿Ñ€ÐµÑ€Ñ‹Ð²Ð½Ð¾**

---

**Ð—Ð°Ð´ÐµÑ€Ð¶ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð°! Ð¢Ð¾Ñ€Ð³Ð¾Ð²Ð»Ñ Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ð±ÐµÐ· Ð¿Ð°ÑƒÐ·.** ðŸŽ‰
