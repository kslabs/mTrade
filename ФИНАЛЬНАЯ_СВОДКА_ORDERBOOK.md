# üéâ –†–ï–§–ê–ö–¢–û–†–ò–ù–ì –ó–ê–í–ï–†–®–Å–ù ‚Äî –ú–æ–¥—É–ª—å orderbook.js

**–î–∞—Ç–∞:** 15 –¥–µ–∫–∞–±—Ä—è 2025  
**–í—Ä–µ–º—è:** ${new Date().toLocaleTimeString('ru-RU')}

---

## ‚úÖ –ß–¢–û –°–î–ï–õ–ê–ù–û

### 1. –°–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å `static/js/orderbook.js`

**–†–∞–∑–º–µ—Ä:** 95 —Å—Ç—Ä–æ–∫

**–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `updateOrderBook(ob)` ‚Äî –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞–∫–∞–Ω–∞ –∑–∞—è–≤–æ–∫
- `setGlobalBuyPrice(price)` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —É—Ä–æ–≤–Ω—è –ø–æ–∫—É–ø–∫–∏
- `setGlobalSellPrice(price)` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —É—Ä–æ–≤–Ω—è –ø—Ä–æ–¥–∞–∂–∏

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `utils.js`: formatPrice, $, logDbg

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è globalBuyPrice/SellPrice –≤–Ω—É—Ç—Ä–∏ –º–æ–¥—É–ª—è
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –±–ª–∏–∑–æ—Å—Ç–∏ –∫ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π —Ü–µ–Ω–µ (mid)
- –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —É—Ä–æ–≤–Ω–µ–π –ø–æ–∫—É–ø–∫–∏/–ø—Ä–æ–¥–∞–∂–∏
- –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –æ–±—ä—ë–º—ã –¥–ª—è asks/bids
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –ª—É—á—à–∏–º —Ü–µ–Ω–∞–º

### 2. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `static/app.js`

**–£–¥–∞–ª–µ–Ω–æ:**
- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: `globalBuyPrice`, `globalSellPrice` (2 —Å—Ç—Ä–æ–∫–∏)
- –§—É–Ω–∫—Ü–∏—è `updateOrderBook(ob)` (76 —Å—Ç—Ä–æ–∫)

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –ò–º–ø–æ—Ä—Ç: `import { updateOrderBook, setGlobalBuyPrice, setGlobalSellPrice } from './js/orderbook.js';`

**–ò–∑–º–µ–Ω–µ–Ω–æ –≤ `updateAutoTradeLevels()`:**
```javascript
// –ë—ã–ª–æ:
globalBuyPrice = levels.next_buy_price;
globalSellPrice = levels.sell_price;

// –°—Ç–∞–ª–æ:
setGlobalBuyPrice(levels.next_buy_price);
setGlobalSellPrice(levels.sell_price);
```

---

## üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤

| –§–∞–π–ª | –ë—ã–ª–æ | –°—Ç–∞–ª–æ | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|------|------|-------|-----------|
| **app.js** | 2519 —Å—Ç—Ä–æ–∫ | **2445 —Å—Ç—Ä–æ–∫** | **‚àí74 (‚àí2.9%)** |
| **orderbook.js** | ‚Äî | **+95 —Å—Ç—Ä–æ–∫** | **(–Ω–æ–≤—ã–π)** |

### –û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

| –≠—Ç–∞–ø | –°—Ç—Ä–æ–∫ | –ü—Ä–æ–≥—Ä–µ—Å—Å |
|------|-------|----------|
| –ù–∞—á–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä | 2676 | ‚Äî |
| –ü–æ—Å–ª–µ utils/ui/api | 2519 | ‚àí157 (‚àí6%) |
| **–ü–æ—Å–ª–µ orderbook** | **2445** | **‚àí231 (‚àí8.6%)** |
| **–î–æ —Ü–µ–ª–∏ (~1800)** | ‚Äî | **34.3%** ‚úÖ |

---

## üîç –ö–ê–ß–ï–°–¢–í–û –ö–û–î–ê

### –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
- ‚úÖ `app.js` ‚Äî **0 –æ—à–∏–±–æ–∫**
- ‚úÖ `orderbook.js` ‚Äî **0 –æ—à–∏–±–æ–∫**

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
1. **–ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è:** globalBuyPrice/SellPrice —Å–∫—Ä—ã—Ç—ã –≤–Ω—É—Ç—Ä–∏ –º–æ–¥—É–ª—è
2. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å:** –õ–æ–≥–∏–∫–∞ —Å—Ç–∞–∫–∞–Ω–∞ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–∞
3. **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ—Å—Ç—å:** –ú–æ–¥—É–ª—å –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö
4. **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å:** –õ–µ–≥—á–µ –ø–æ–∫—Ä—ã—Ç—å unit-—Ç–µ—Å—Ç–∞–º–∏
5. **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å:** app.js –∫–æ—Ä–æ—á–µ –Ω–∞ 74 —Å—Ç—Ä–æ–∫–∏

---

## üì¶ –°–û–ó–î–ê–ù–ù–´–ï –ú–û–î–£–õ–ò (–≤—Å–µ–≥–æ 4)

1. ‚úÖ `static/js/utils.js` ‚Äî —É—Ç–∏–ª–∏—Ç—ã (logDbg, formatPrice, $, formatUptime)
2. ‚úÖ `static/js/ui-helpers.js` ‚Äî UI-—Ö–µ–ª–ø–µ—Ä—ã (–º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞)
3. ‚úÖ `static/js/api-client.js` ‚Äî API-–∫–ª–∏–µ–Ω—Ç (fetch-–≤—ã–∑–æ–≤—ã)
4. ‚úÖ `static/js/orderbook.js` ‚Äî —Å—Ç–∞–∫–∞–Ω –∑–∞—è–≤–æ–∫ **(–ù–û–í–´–ô!)** üéâ

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

### –ì–æ—Ç–æ–≤—ã –∫ –≤—ã–Ω–æ—Å—É (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É):

1. **–¢–∞–±–ª–∏—Ü–∞ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏** (~86 —Å—Ç—Ä–æ–∫)
   - `renderBreakEvenTable()`
   - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: $, globalActiveStep, currentPairPricePrecision

2. **–§—É–Ω–∫—Ü–∏–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤** (~129 —Å—Ç—Ä–æ–∫)
   - `updateTradeIndicators()`
   - `updateAutoTradeLevels()`
   - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –º–Ω–æ–≥–æ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

3. **–ú–µ–Ω–µ–¥–∂–µ—Ä –≤–∞–ª—é—Ç** (~156 —Å—Ç—Ä–æ–∫)
   - `openCurrencyManager()`, `closeCurrencyManager()`
   - `buildCurrencyManagerRows()`, `addCurrencyRow()`
   - `saveCurrenciesList()`, `syncCurrenciesFromGateIO()`

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:

1. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. ‚è≠Ô∏è –í—ã–Ω–µ—Å—Ç–∏ —Ç–∞–±–ª–∏—Ü—É –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏ (—Å–∞–º–∞—è –ø—Ä–æ—Å—Ç–∞—è)
3. ‚è≠Ô∏è –í—ã–Ω–µ—Å—Ç–∏ –º–µ–Ω–µ–¥–∂–µ—Ä –≤–∞–ª—é—Ç (–≥—Ä—É–ø–ø–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π)
4. ‚è≠Ô∏è –í—ã–Ω–µ—Å—Ç–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (—Å–∞–º–∞—è —Å–ª–æ–∂–Ω–∞—è, –º–Ω–æ–≥–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)

---

## üìù –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

–°–æ–∑–¥–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã:

1. ‚úÖ `–†–ï–§–ê–ö–¢–û–†–ò–ù–ì_ORDERBOOK_–£–°–ü–ï–®–ï–ù.md` ‚Äî –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á—ë—Ç
2. ‚úÖ `–ë–´–°–¢–†–ê–Ø_–°–í–û–î–ö–ê_ORDERBOOK.md` ‚Äî –∫—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞
3. ‚úÖ `–ò–ù–°–¢–†–£–ö–¶–ò–Ø_–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø_ORDERBOOK.md` ‚Äî —á–µ–∫-–ª–∏—Å—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
4. ‚úÖ `–¢–ï–ö–£–©–ï–ï_–°–û–°–¢–û–Ø–ù–ò–ï_–ü–†–û–ï–ö–¢–ê.md` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –æ–±—â–∞—è —Å–≤–æ–¥–∫–∞

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ—Ç—Ä–µ–π–¥–µ—Ä–∞ (–°–û–•–†–ê–ù–ï–ù–´):
- ‚úÖ –£–±—Ä–∞–Ω `abs()` –ø—Ä–∏ —Ä–∞—Å—á—ë—Ç–µ decrease_step_pct
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —É—Å–ª–æ–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (—É–±—Ä–∞–Ω–æ `or decrease_step_pct <= 0`)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–Ω—ã —Å—Ç–∞–∫–∞–Ω–∞ –¥–ª—è –¥–æ–∫—É–ø–æ–∫ –∏ –ø—Ä–æ–¥–∞–∂

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:
- ‚úÖ –í—ã–Ω–µ—Å–µ–Ω–∞ **–æ–¥–Ω–∞** —Ñ—É–Ω–∫—Ü–∏—è –∑–∞ —Ä–∞–∑
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
- ‚úÖ –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å –∏–º–ø–æ—Ä—Ç–∞–º–∏
- ‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ**

---

## üöÄ –ó–ê–ü–£–°–ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø

```powershell
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd "c:\Users\–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä\Documents\bGate.mTrade"

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
python main.py

# –û—Ç–∫—Ä—ã—Ç—å –±—Ä–∞—É–∑–µ—Ä: http://localhost:5001

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
# 1. –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –±–µ–∑ –æ—à–∏–±–æ–∫
# 2. –°—Ç–∞–∫–∞–Ω –∑–∞—è–≤–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
# 3. –£—Ä–æ–≤–Ω–∏ –ø–æ–∫—É–ø–∫–∏/–ø—Ä–æ–¥–∞–∂–∏ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—é—Ç—Å—è
# 4. WebSocket –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞–∫–∞–Ω
```

---

## ‚úÖ –ö–†–ò–¢–ï–†–ò–ò –£–°–ü–ï–•–ê

- [x] –ú–æ–¥—É–ª—å —Å–æ–∑–¥–∞–Ω –∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω
- [x] –§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∞ –∏–∑ app.js
- [x] –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –Ω–µ—Ç
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ (—Ä—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [ ] –°—Ç–∞–∫–∞–Ω –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (—Ä—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [ ] –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —É—Ä–æ–≤–Ω–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç (—Ä—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ì–û–¢–û–í–û –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ**

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ä—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–≥–ª–∞—Å–Ω–æ `–ò–ù–°–¢–†–£–ö–¶–ò–Ø_–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø_ORDERBOOK.md`
