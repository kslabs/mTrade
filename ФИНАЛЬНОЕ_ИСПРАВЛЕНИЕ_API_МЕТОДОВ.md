# ‚úÖ –§–ò–ù–ê–õ–¨–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï API –ú–ï–¢–û–î–û–í

## üéØ –ü–†–û–ë–õ–ï–ú–ê

–í —Ñ—É–Ω–∫—Ü–∏–∏ `_try_sell_idle_balance` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å **–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã API**:

1. ‚ùå `api_client.get_pair_info(pair)` ‚Äî –º–µ—Ç–æ–¥ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
2. ‚ùå `api_client.create_order(pair=..., side=..., amount=..., price=...)` ‚Äî –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∞

**–û—à–∏–±–∫–∞ –∏–∑ –ª–æ–≥–æ–≤:**
```
AttributeError: 'GateAPIClient' object has no attribute 'get_pair_info'
```

---

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤–∞–ª—é—Ç–Ω–æ–π –ø–∞—Ä–µ

**–ë—ã–ª–æ:**
```python
pair = f"{base}_{quote}"
pair_info = api_client.get_pair_info(pair)  # ‚ùå –ú–µ—Ç–æ–¥ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
```

**–°—Ç–∞–ª–æ:**
```python
pair = f"{base}_{quote}".upper()
pair_info = api_client.get_currency_pair_details_exact(pair)  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –º–µ—Ç–æ–¥
```

‚úÖ **–¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –º–µ—Ç–æ–¥ `get_currency_pair_details_exact()`**

---

### 2. –°–æ–∑–¥–∞–Ω–∏–µ spot –æ—Ä–¥–µ—Ä–∞ –Ω–∞ –ø—Ä–æ–¥–∞–∂—É

**–ë—ã–ª–æ:**
```python
result = api_client.create_order(
    pair=pair,
    side='sell',
    amount=sell_amount_rounded,
    price=orderbook_price
)  # ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∞
```

**–°—Ç–∞–ª–æ:**
```python
result = api_client.create_spot_order(
    currency_pair=pair,
    side='sell',
    order_type='limit',
    amount=str(sell_amount_rounded),
    price=str(orderbook_price),
    time_in_force='ioc'  # Immediate-Or-Cancel
)  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∞
```

‚úÖ **–¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `create_spot_order()` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏**

---

## üìä –î–ï–¢–ê–õ–ò –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### –ú–µ—Ç–æ–¥ `get_currency_pair_details_exact()`

**–ì–¥–µ –Ω–∞–π–¥–µ–Ω:** `gate_api_client.py`, —Å—Ç—Ä–æ–∫–∞ 425

**–ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
{
    'id': 'DOGE_USDT',
    'base': 'DOGE',
    'quote': 'USDT',
    'min_base_amount': '10.0',       # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—ä—ë–º –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç—ã
    'min_quote_amount': '1.0',       # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤ quote
    'amount_precision': 8,            # –¢–æ—á–Ω–æ—Å—Ç—å –æ–±—ä—ë–º–∞
    'precision': 8,                   # –¢–æ—á–Ω–æ—Å—Ç—å —Ü–µ–Ω—ã
    ...
}
```

---

### –ú–µ—Ç–æ–¥ `create_spot_order()`

**–ì–¥–µ –Ω–∞–π–¥–µ–Ω:** `gate_api_client.py`, —Å—Ç—Ä–æ–∫–∞ 183

**–°–∏–≥–Ω–∞—Ç—É—Ä–∞:**
```python
def create_spot_order(
    self,
    currency_pair: str,      # –ü–∞—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'DOGE_USDT')
    side: str,               # 'buy' –∏–ª–∏ 'sell'
    amount: str,             # –û–±—ä—ë–º (—Å—Ç—Ä–æ–∫–∞!)
    price: str = None,       # –¶–µ–Ω–∞ (—Å—Ç—Ä–æ–∫–∞!)
    order_type: str = "limit",  # –¢–∏–ø: 'limit', 'market'
    time_in_force: str = None   # 'gtc', 'ioc', 'fok'
)
```

**time_in_force='ioc':**
- **IOC (Immediate-Or-Cancel)** ‚Äî –∏—Å–ø–æ–ª–Ω–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω—ã–π –æ–±—ä—ë–º –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ, –æ—Å—Ç–∞—Ç–æ–∫ –æ—Ç–º–µ–Ω–∏—Ç—å
- –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤, –∫–æ–≥–¥–∞ –æ–±—ä—ë–º –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º

---

## üîç –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø

### 1. –§–æ—Ä–º–∞—Ç –ø–∞—Ä—ã (uppercase)
```python
# –ë–´–õ–û:
pair = f"{base}_{quote}"

# –°–¢–ê–õ–û:
pair = f"{base}_{quote}".upper()
```

‚úÖ –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –ø–∞—Ä—ã –¥–ª—è API (–Ω–∞–ø—Ä–∏–º–µ—Ä, `DOGE_USDT` –≤–º–µ—Å—Ç–æ `doge_usdt`)

---

### 2. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ —Å—Ç—Ä–æ–∫–∏
```python
# amount –∏ price –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞–º–∏!
amount=str(sell_amount_rounded),
price=str(orderbook_price)
```

‚úÖ API Gate.io —Ç—Ä–µ–±—É–µ—Ç —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê

### –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
```bash
get_errors("autotrader_v2.py")
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ **No errors found**

### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ `get_currency_pair_details_exact()`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ `create_spot_order()`
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
- ‚úÖ –ü–∞—Ä–∞ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ uppercase
- ‚úÖ IOC –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø—Ä–æ–¥–∞–∂—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –æ–±—ä—ë–º–∞

---

## üöÄ –û–ñ–ò–î–ê–ï–ú–´–ï –õ–û–ì–ò

### –£—Å–ø–µ—à–Ω–∞—è –ø—Ä–æ–¥–∞–∂–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤:
```
[DOGE] üîÑ === –ê–í–¢–û–ü–†–û–î–ê–ñ–ê –û–°–¢–ê–¢–ö–û–í –í IDLE –°–û–°–¢–û–Ø–ù–ò–ò ===
[DOGE] üí∞ –î–æ—Å—Ç—É–ø–Ω—ã–π –±–∞–ª–∞–Ω—Å –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏: 72.01213000
[DOGE] üìä –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞—Ä—ã: min_base=10.0, min_quote=1.0
[DOGE] üöÄ –°–æ–∑–¥–∞–µ–º –æ—Ä–¥–µ—Ä –Ω–∞ –ø—Ä–æ–¥–∞–∂—É –æ—Å—Ç–∞—Ç–∫–æ–≤:
[DOGE] üöÄ   –û–±—ä–µ–º: 72.01 DOGE
[DOGE] üöÄ   –¶–µ–Ω–∞: 0.13998000 USDT
[DOGE] üöÄ   –°—Ç–æ–∏–º–æ—Å—Ç—å: 10.08 USDT
[DOGE] ‚úÖ –û—Ä–¥–µ—Ä —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ: 123456789
[DOGE] üîÑ –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ü–∏–∫–ª –ø–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤
[DOGE] ‚úÖ –¶–∏–∫–ª —Å–±—Ä–æ—à–µ–Ω –ø–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤
```

### –°–±—Ä–æ—Å —Ü–∏–∫–ª–∞ (–æ—Å—Ç–∞—Ç–∫–∏ —Å–ª–∏—à–∫–æ–º –º–∞–ª—ã):
```
[DOGE] üîÑ === –ê–í–¢–û–ü–†–û–î–ê–ñ–ê –û–°–¢–ê–¢–ö–û–í –í IDLE –°–û–°–¢–û–Ø–ù–ò–ò ===
[DOGE] üí∞ –î–æ—Å—Ç—É–ø–Ω—ã–π –±–∞–ª–∞–Ω—Å –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏: 0.50000000
[DOGE] üìä –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞—Ä—ã: min_base=10.0, min_quote=1.0
[DOGE] ‚ö†Ô∏è –û–±—ä–µ–º 0.5 –º–µ–Ω—å—à–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ 10.0
[DOGE] üóëÔ∏è –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ü–∏–∫–ª, –æ—Å—Ç–∞—Ç–∫–∏ —Å–ª–∏—à–∫–æ–º –º–∞–ª—ã –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏
[DOGE] ‚úÖ –¶–∏–∫–ª —Å–±—Ä–æ—à–µ–Ω, –æ—Å—Ç–∞—Ç–∫–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è
```

---

## üìã –ò–¢–û–ì–ò –í–°–ï–• –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –°—Ç–∞—Ç—É—Å |
|---|----------|--------|
| 1 | `api_client.get_balance()` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç | ‚úÖ –ó–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ `get_account_balance()` |
| 2 | `self._reset_cycle()` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç | ‚úÖ –ó–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ `cycles[base].reset()` |
| 3 | `self.locks[base]` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç | ‚úÖ –ó–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ `_get_lock(base)` |
| 4 | `api_client.get_pair_info()` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç | ‚úÖ –ó–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ `get_currency_pair_details_exact()` |
| 5 | `api_client.create_order()` –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ | ‚úÖ –ó–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ `create_spot_order()` |
| 6 | –ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ—Å–ª–µ —Å–±—Ä–æ—Å–∞ | ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ `_save_state(base)` |

**–ò–¢–û–ì–û:** 6 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

---

## üéØ –†–ï–ó–£–õ–¨–¢–ê–¢

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å –¥–æ | –°—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ |
|-----------|-----------|--------------|
| –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ | ‚ùå `get_balance()` | ‚úÖ `get_account_balance()` |
| –°–±—Ä–æ—Å —Ü–∏–∫–ª–∞ | ‚ùå `_reset_cycle()` | ‚úÖ `cycles[base].reset()` |
| –î–æ—Å—Ç—É–ø –∫ locks | ‚ùå `self.locks[base]` | ‚úÖ `_get_lock(base)` |
| –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞—Ä–µ | ‚ùå `get_pair_info()` | ‚úÖ `get_currency_pair_details_exact()` |
| –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ä–¥–µ—Ä–∞ | ‚ùå `create_order()` | ‚úÖ `create_spot_order()` |
| –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ | ‚ùå –ï—Å—Ç—å | ‚úÖ –ù–µ—Ç |
| **–ê–≤—Ç–æ–ø—Ä–æ–¥–∞–∂–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤** | ‚ùå **–ù–ï –†–ê–ë–û–¢–ê–õ–ê** | ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢** |

---

**–î–ê–¢–ê:** 12 –¥–µ–∫–∞–±—Ä—è 2025 –≥.  
**–§–ê–ô–õ:** autotrader_v2.py  
**–§–£–ù–ö–¶–ò–Ø:** `_try_sell_idle_balance`  
**–°–¢–ê–¢–£–°:** ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–û –ò –ì–û–¢–û–í–û –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ**
