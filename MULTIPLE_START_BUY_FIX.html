<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ç–∞—Ä—Ç–æ–≤—ã—Ö –ø–æ–∫—É–ø–æ–∫</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        h1 {
            color: #667eea;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        .problem {
            background: #ffe5e5;
            border-left: 4px solid #ff4444;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .solution {
            background: #e5ffe5;
            border-left: 4px solid #44ff44;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .code {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            margin: 10px 0;
        }
        .timeline {
            background: #f0f7ff;
            border: 2px solid #667eea;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        .emoji {
            font-size: 24px;
            margin-right: 8px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background: #667eea;
            color: white;
        }
        .status {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1><span class="emoji">üîß</span>–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ç–∞—Ä—Ç–æ–≤—ã—Ö –ø–æ–∫—É–ø–æ–∫</h1>
        
        <div class="status">
            ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û –ò –ì–û–¢–û–í–û –ö PRODUCTION
        </div>

        <h2><span class="emoji">üêõ</span>–ü—Ä–æ–±–ª–µ–º–∞</h2>
        <div class="problem">
            <p>–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ, —á—Ç–æ –¥–ª—è –æ–¥–Ω–æ–π –≤–∞–ª—é—Ç—ã (ETH) –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç <strong>–Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç–∞—Ä—Ç–æ–≤—ã—Ö –ø–æ–∫—É–ø–æ–∫ –ø–æ–¥—Ä—è–¥</strong>:</p>
            <div class="code">
[06:11:54] [ETH] Sell  - –ø—Ä–æ–¥–∞–∂–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞, —Ü–∏–∫–ª –∑–∞–∫—Ä—ã—Ç (active=False)
[06:11:56] [ETH] Buy   - –ü–ï–†–í–ê–Ø —Å—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞ (10.0291 USDT)
[06:12:13] [ETH] Buy   - –í–¢–û–†–ê–Ø —Å—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞ (10.0290 USDT) ‚ö†Ô∏è –î–£–ë–õ–ò–ö–ê–¢!
            </div>
            <p><strong>–ò–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –ø–æ–∫—É–ø–∫–∞–º–∏:</strong> 17 —Å–µ–∫—É–Ω–¥</p>
        </div>

        <h2><span class="emoji">üîç</span>–ü—Ä–∏—á–∏–Ω–∞</h2>
        <p>–ü—Ä–æ–±–ª–µ–º–∞ –≤ <strong>–∑–∞–¥–µ—Ä–∂–∫–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Ü–∏–∫–ª–∞</strong>:</p>
        
        <div class="timeline">
            <h3>–¢–∞–π–º–ª–∞–π–Ω –ø—Ä–æ–±–ª–µ–º—ã:</h3>
            <table>
                <thead>
                    <tr>
                        <th>–í—Ä–µ–º—è</th>
                        <th>–ü–æ—Ç–æ–∫ #1</th>
                        <th>–ü–æ—Ç–æ–∫ #2</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>00:00</td>
                        <td>‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞: active=False</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>00:01</td>
                        <td>‚úÖ –ó–∞—Ö–≤–∞—Ç Lock</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>00:02</td>
                        <td>‚è±Ô∏è –ù–∞—á–∞–ª–æ –ø–æ–∫—É–ø–∫–∏...</td>
                        <td>‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞: active=False</td>
                    </tr>
                    <tr>
                        <td>00:03</td>
                        <td>‚è±Ô∏è ...–ø–æ–∫—É–ø–∫–∞ –Ω–∞ –±–∏—Ä–∂–µ...</td>
                        <td>‚è±Ô∏è –û–∂–∏–¥–∞–Ω–∏–µ Lock...</td>
                    </tr>
                    <tr>
                        <td>00:15</td>
                        <td>‚úÖ –ü–æ–∫—É–ø–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞</td>
                        <td>‚è±Ô∏è ...–æ–∂–∏–¥–∞–Ω–∏–µ...</td>
                    </tr>
                    <tr>
                        <td>00:16</td>
                        <td>‚úÖ active=True</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>00:17</td>
                        <td>‚úÖ –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ Lock</td>
                        <td>‚úÖ –ó–∞—Ö–≤–∞—Ç Lock</td>
                    </tr>
                    <tr>
                        <td>00:18</td>
                        <td></td>
                        <td>‚ùå –ù–∞—á–∞–ª–æ –ø–æ–∫—É–ø–∫–∏ (–î–£–ë–õ–ò–ö–ê–¢!)</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h2><span class="emoji">‚úÖ</span>–†–µ—à–µ–Ω–∏–µ</h2>
        
        <div class="solution">
            <h3>1. –ó–∞—â–∏—Ç–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–ø—ã—Ç–∫–∏ —Å—Ç–∞—Ä—Ç–∞</h3>
            <p><strong>–ù–æ–≤–æ–µ –ø–æ–ª–µ:</strong> <code>last_start_attempt</code> - –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–æ–ø—ã—Ç–∫–∏ –∑–∞–ø—É—Å–∫–∞ —Ü–∏–∫–ª–∞</p>
            <div class="code">
# –ü—Ä–æ–≤–µ—Ä–∫–∞: –Ω–µ –±—ã–ª–æ –ª–∏ –Ω–µ–¥–∞–≤–Ω–µ–π –ø–æ–ø—ã—Ç–∫–∏ —Å—Ç–∞—Ä—Ç–∞?
current_time = time.time()
last_attempt = cycle.get('last_start_attempt', 0)

if last_attempt > 0 and (current_time - last_attempt) < 3.0:
    time_since = current_time - last_attempt
    print(f"[START_PROTECTION][{base}] ‚è±Ô∏è –ë–õ–û–ö–ò–†–û–í–ö–ê: "
          f"–ø–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ø—ã—Ç–∫–∞ —Å—Ç–∞—Ä—Ç–∞ –±—ã–ª–∞ {time_since:.2f}s –Ω–∞–∑–∞–¥ (< 3s)")
    return

# –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤—Ä–µ–º—è –ø–æ–ø—ã—Ç–∫–∏ –°–†–ê–ó–£ (–¥–æ Lock –∏ –¥–æ –ø–æ–∫—É–ø–∫–∏)
cycle['last_start_attempt'] = current_time
self.cycles[base] = cycle
            </div>
        </div>

        <div class="solution">
            <h3>2. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏</h3>
            <p><strong>–ù–æ–≤–æ–µ –ø–æ–ª–µ:</strong> <code>cycle_activated_at</code> - –≤—Ä–µ–º—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Ü–∏–∫–ª–∞</p>
            <div class="code">
buy_completed_at = time.time()
order_start_time = cycle.get('last_start_attempt', buy_completed_at)
buy_duration = buy_completed_at - order_start_time

print(f"[{base}] ‚è±Ô∏è –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–∫—É–ø–∫–∏: {buy_duration:.3f}s")
print(f"[{base}] ‚è±Ô∏è –í—Ä–µ–º—è –æ—Ç –ø–æ–ø—ã—Ç–∫–∏ –¥–æ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏: {buy_duration:.3f}s")

cycle.update({
    'active': True,
    'cycle_activated_at': buy_completed_at  # –ù–û–í–û–ï!
})
            </div>
        </div>

        <div class="solution">
            <h3>3. –£–¥–∞–ª–µ–Ω—ã –ª–∏—à–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏</h3>
            <p>–£–±—Ä–∞–Ω—ã –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ "–∫–æ—Å—Ç—ã–ª–∏":</p>
            <ul>
                <li>‚ùå –ü—Ä–æ–≤–µ—Ä–∫–∞ <code>if cycle.get('active')</code> –ø–æ—Å–ª–µ –ø–æ–∫—É–ø–∫–∏</li>
                <li>‚ùå –ü—Ä–æ–≤–µ—Ä–∫–∞ <code>if current_base_in_quote >= purchase_usd * 1.8</code></li>
            </ul>
            <p>–≠—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å —Å–ª–∏—à–∫–æ–º –ø–æ–∑–¥–Ω–æ –∏ –Ω–µ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–ª–∏ –≤—Ç–æ—Ä—É—é –ø–æ–ø—ã—Ç–∫—É —Å—Ç–∞—Ä—Ç–∞.</p>
        </div>

        <h2><span class="emoji">üìä</span>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞—â–∏—Ç–∞</h2>
        
        <div class="timeline">
            <h3>–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:</h3>
            <table>
                <thead>
                    <tr>
                        <th>–í—Ä–µ–º—è</th>
                        <th>–ü–æ—Ç–æ–∫ #1</th>
                        <th>–ü–æ—Ç–æ–∫ #2</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>00:00</td>
                        <td>‚úÖ active=False</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>00:01</td>
                        <td>‚úÖ last_start_attempt=00:01</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>00:02</td>
                        <td>‚úÖ Lock + –Ω–∞—á–∞–ª–æ –ø–æ–∫—É–ø–∫–∏</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>00:04</td>
                        <td>‚è±Ô∏è ...–ø–æ–∫—É–ø–∫–∞...</td>
                        <td>‚úÖ active=False</td>
                    </tr>
                    <tr>
                        <td>00:05</td>
                        <td>‚è±Ô∏è ...–ø–æ–∫—É–ø–∫–∞...</td>
                        <td>‚è±Ô∏è last_attempt=00:01</td>
                    </tr>
                    <tr>
                        <td>00:06</td>
                        <td>‚è±Ô∏è ...–ø–æ–∫—É–ø–∫–∞...</td>
                        <td>‚ùå time_since=5s > 3s</td>
                    </tr>
                    <tr>
                        <td>00:07</td>
                        <td>‚è±Ô∏è ...–ø–æ–∫—É–ø–∫–∞...</td>
                        <td>üõë <strong>–ë–õ–û–ö–ò–†–û–í–ö–ê!</strong> return</td>
                    </tr>
                    <tr>
                        <td>00:15</td>
                        <td>‚úÖ –ü–æ–∫—É–ø–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>00:16</td>
                        <td>‚úÖ active=True</td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h2><span class="emoji">üß™</span>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h2>
        
        <h3>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ª–æ–≥–∞—Ö:</h3>
        <div class="code">
# –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç—ã –∑–∞—â–∏—Ç—ã
Select-String -Path system_trader.log -Pattern "START_PROTECTION"

# –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–∫—É–ø–æ–∫
Select-String -Path system_trader.log -Pattern "–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–∫—É–ø–∫–∏"

# –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –¥–ª—è ETH
Select-String -Path system_trader.log -Pattern "ETH.*Buy"
        </div>

        <h3>–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</h3>
        <div class="code">
[START_CYCLE][ETH] ‚úÖ –í–°–ï –£–°–õ–û–í–ò–Ø –í–´–ü–û–õ–ù–ï–ù–´! –ù–∞—á–∏–Ω–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—É—é –ø–æ–∫—É–ø–∫—É...
[ETH] ‚úÖ –£—Å–ø–µ—à–Ω–∞—è –ø–æ–∫—É–ø–∫–∞: filled=0.00329, price=3039.09, invested=10.00
[ETH] ‚è±Ô∏è –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–∫—É–ø–∫–∏: 15.234s
[ETH] üéØ –¶–∏–∫–ª –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω: active=True, start_price=3039.09

# –ü–æ–ø—ã—Ç–∫–∞ –≤—Ç–æ—Ä–æ–≥–æ –ø–æ—Ç–æ–∫–∞ (–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞):
[START_PROTECTION][ETH] ‚è±Ô∏è –ë–õ–û–ö–ò–†–û–í–ö–ê: –ø–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ø—ã—Ç–∫–∞ —Å—Ç–∞—Ä—Ç–∞ –±—ã–ª–∞ 2.45s –Ω–∞–∑–∞–¥ (< 3s)
        </div>

        <h2><span class="emoji">‚úÖ</span>–†–µ–∑—É–ª—å—Ç–∞—Ç</h2>
        <ul>
            <li>‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ç–∞—Ä—Ç–æ–≤—ã—Ö –ø–æ–∫—É–ø–æ–∫</li>
            <li>‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</li>
            <li>‚úÖ –£–¥–∞–ª–µ–Ω—ã –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ "–∫–æ—Å—Ç—ã–ª–∏"</li>
            <li>‚úÖ –ö–æ–¥ –ø—Ä–æ–≤–µ—Ä–µ–Ω (0 —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫)</li>
            <li>‚úÖ –ì–æ—Ç–æ–≤–æ –∫ production —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é</li>
        </ul>

        <h2><span class="emoji">üöÄ</span>–î–µ–ø–ª–æ–π</h2>
        <ol>
            <li>–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ <code>autotrader.py</code></li>
            <li>–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏: <code>Get-Content system_trader.log -Wait | Select-String "START_PROTECTION"</code></li>
            <li>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –Ω–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫ –¥–ª—è –æ–¥–Ω–æ–π –≤–∞–ª—é—Ç—ã</li>
        </ol>

        <div class="status">
            <p><strong>–°—Ç–∞—Ç—É—Å:</strong> ‚úÖ –ì–û–¢–û–í–û –ö PRODUCTION</p>
            <p><strong>–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:</strong> –°–∏–Ω—Ç–∞–∫—Å–∏—Å ‚úÖ | –õ–æ–≥–∏–∫–∞ ‚úÖ | –û—à–∏–±–∫–∏: 0</p>
        </div>
    </div>
</body>
</html>
