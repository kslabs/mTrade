# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ total_invested –∏–∑ –ª–æ–≥–æ–≤

## üêõ –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ `total_invested` (–Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è —Å—É–º–º–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π) –æ–±–Ω—É–ª—è–ª–∞—Å—å, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ö—Ä–∞–Ω–∏–ª–∞—Å—å —Ç–æ–ª—å–∫–æ –≤ –ø–∞–º—è—Ç–∏ (`self.total_invested = {}`).

–ò–∑-–∑–∞ —ç—Ç–æ–≥–æ –≤ –ª–æ–≥–∞—Ö –ø–æ–∫–∞–∑—ã–≤–∞–ª–æ—Å—å:
```
[16:28:52] [ETH] Buy{9.8195; –ò–Ω–≤–µ—Å—Ç:9.8195}  ‚Üê –ø–µ—Ä–≤–∞—è –ø–æ–∫—É–ø–∫–∞
[16:34:09] [ETH] Buy{13.5358; –ò–Ω–≤–µ—Å—Ç:13.5358}  ‚Üê –≤—Ç–æ—Ä–∞—è –ø–æ–∫—É–ø–∫–∞, –Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è —Å—É–º–º–∞!
```

–î–æ–ª–∂–Ω–æ –±—ã–ª–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å:
```
[16:28:52] [ETH] Buy{9.8195; –ò–Ω–≤–µ—Å—Ç:9.8195}  ‚Üê –ø–µ—Ä–≤–∞—è –ø–æ–∫—É–ø–∫–∞
[16:34:09] [ETH] Buy{13.5358; –ò–Ω–≤–µ—Å—Ç:23.3553}  ‚Üê 9.8195 + 13.5358 = 23.3553
```

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ `total_invested` –∏–∑ –ª–æ–≥–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ `TradeLogger`.

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `trade_logger.py`

```python
def _load_logs_for_currency(self, currency: str):
    """–ó–∞–≥—Ä—É–∑–∏—Ç—å –ª–æ–≥–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–∞–ª—é—Ç—ã –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å total_invested"""
    currency = currency.upper()
    log_file = self._get_log_file_path(currency)
    
    if not os.path.exists(log_file):
        return
    
    try:
        logs = deque(maxlen=self.MAX_LOG_ENTRIES)
        last_total_invested = 0.0  # ‚Üê –ù–û–í–û–ï: –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        
        with open(log_file, 'r', encoding='utf-8') as f:
            for line in f:
                line = line.strip()
                if line:
                    try:
                        entry = json.loads(line)
                        logs.append(entry)
                        
                        # ‚Üê –ù–û–í–û–ï: –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º total_invested –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–ø–∏—Å–∏
                        if entry.get('type') == 'buy' and 'total_invested' in entry:
                            last_total_invested = entry['total_invested']
                        elif entry.get('type') == 'sell':
                            # –ü–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏ total_invested = 0
                            last_total_invested = 0.0
                    except json.JSONDecodeError:
                        continue
        
        self.logs_by_currency[currency] = logs
        self.total_invested[currency] = last_total_invested  # ‚Üê –ù–û–í–û–ï: –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∑ –ª–æ–≥–æ–≤
        
        print(f"[TRADE_LOGGER] –ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(logs)} –∑–∞–ø–∏—Å–µ–π –¥–ª—è {currency}, total_invested={last_total_invested:.4f}")
    except Exception as e:
        print(f"[TRADE_LOGGER] –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥–æ–≤ –¥–ª—è {currency}: {e}")
```

## üìù –õ–æ–≥–∏–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

1. **–ü—Ä–∏ –ø–æ–∫—É–ø–∫–µ (buy):** –±–µ—Ä—ë–º –∑–Ω–∞—á–µ–Ω–∏–µ `total_invested` –∏–∑ entry –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º
2. **–ü—Ä–∏ –ø—Ä–æ–¥–∞–∂–µ (sell):** –æ–±–Ω—É–ª—è–µ–º `total_invested` (—Ü–∏–∫–ª –∑–∞–≤–µ—Ä—à—ë–Ω)
3. **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ** `total_invested` —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ç–µ–∫—É—â–∏–º –¥–ª—è –≤–∞–ª—é—Ç—ã

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞:
- ‚úÖ `total_invested` –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–ø–∏—Å–∏ –≤ –ª–æ–≥–µ
- ‚úÖ –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –í –ª–æ–≥–∞—Ö –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è —Å—É–º–º–∞

### –ü—Ä–∏–º–µ—Ä (–ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞):

**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
[–°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω]
[16:34:09] [ETH] Buy{13.5358; –ò–Ω–≤–µ—Å—Ç:13.5358}  ‚Üê –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –ø–æ—Ç–µ—Ä—è–ª–∏—Å—å –ø—Ä–µ–¥—ã–¥—É—â–∏–µ 9.8195
```

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
[–°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω]
[TRADE_LOGGER] –ó–∞–≥—Ä—É–∂–µ–Ω–æ 1 –∑–∞–ø–∏—Å–µ–π –¥–ª—è ETH, total_invested=9.8195  ‚Üê –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∏–∑ –ª–æ–≥–∞
[16:34:09] [ETH] Buy{13.5358; –ò–Ω–≤–µ—Å—Ç:23.3553}  ‚Üê –ø—Ä–∞–≤–∏–ª—å–Ω–æ! 9.8195 + 13.5358
```

## üöÄ –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è `[TRADE_LOGGER] –ó–∞–≥—Ä—É–∂–µ–Ω–æ N –∑–∞–ø–∏—Å–µ–π –¥–ª—è XXX, total_invested=Y.YYYY`
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –¥–æ–∫—É–ø–∫—É –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ –ª–æ–≥–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è —Å—É–º–º–∞

---

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!** ‚úÖ  
**–§–∞–π–ª:** `trade_logger.py`  
**–î–∞—Ç–∞:** 2025-12-12
