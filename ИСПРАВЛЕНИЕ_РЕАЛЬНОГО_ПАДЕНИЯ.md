# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –†–µ–∞–ª—å–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å >= —Ç–∞–±–ª–∏—á–Ω–æ–º—É

**–î–∞—Ç–∞**: 2025  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û  

---

## üî• –ü—Ä–æ–±–ª–µ–º–∞

**–†–µ–∞–ª—å–Ω–æ–µ ‚ÜìŒî% –±—ã–ª–æ –º–µ–Ω—å—à–µ —Ç–∞–±–ª–∏—á–Ω–æ–≥–æ:**
```
[21:10:29] [WLD] Buy{25.7694; –ö—É—Ä—Å:0.5635; ‚ÜìŒî%:-0.69; ‚Üì%:-2.34}  ‚ùå –¢–æ–ª—å–∫–æ -0.69%!
[18:13:54] [WLD] Buy{18.7963; –ö—É—Ä—Å:0.5674; ‚ÜìŒî%:-0.96; ‚Üì%:-1.66}
```

**–û–∂–∏–¥–∞–ª–æ—Å—å**: ‚ÜìŒî% ‚â• -3% (–∏–ª–∏ –±–æ–ª—å—à–µ, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∞–±–ª–∏—Ü—ã)

---

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–∏—á–∏–Ω—ã

### –¢–∞–±–ª–∏—á–Ω—ã–µ —Ü–µ–Ω—ã (–ø—Ä–∏ P0 = 0.5770 –∏ –ø–∞–¥–µ–Ω–∏–∏ -3%):
```
–®–∞–≥ 0: 0.5770
–®–∞–≥ 1: 0.5597 (-3.00%)
–®–∞–≥ 2: 0.5429 (-3.00%)
–®–∞–≥ 3: 0.5266 (-3.00%)
```

### –†–µ–∞–ª—å–Ω—ã–µ —Ü–µ–Ω—ã –ø–æ–∫—É–ø–æ–∫:
```
–®–∞–≥ 0: 0.5770 ‚úÖ
–®–∞–≥ 1: 0.5729 ‚ùå (+2.36% –≤—ã—à–µ —Ç–∞–±–ª–∏—á–Ω–æ–π!)
–®–∞–≥ 2: 0.5674 ‚ùå (+4.51% –≤—ã—à–µ —Ç–∞–±–ª–∏—á–Ω–æ–π!)
–®–∞–≥ 3: 0.5635 ‚ùå (+7.01% –≤—ã—à–µ —Ç–∞–±–ª–∏—á–Ω–æ–π!)
```

### –ü–æ—á–µ–º—É —Ç–∞–∫ –ø—Ä–æ–∏–∑–æ—à–ª–æ?

**–°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞**:
```python
rebuy_threshold = tabular_rate  # –¢–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—á–Ω–∞—è —Ü–µ–Ω–∞
if price >= rebuy_threshold:    # –ü–æ–∫—É–ø–∞–µ–º, –µ—Å–ª–∏ —Ü–µ–Ω–∞ <= —Ç–∞–±–ª–∏—á–Ω–æ–π
    return
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –ï—Å–ª–∏ –ø—Ä–µ–¥—ã–¥—É—â–∞—è –ø–æ–∫—É–ø–∫–∞ –±—ã–ª–∞ **–≤—ã—à–µ** —Ç–∞–±–ª–∏—á–Ω–æ–π —Ü–µ–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, 0.5729 –≤–º–µ—Å—Ç–æ 0.5597), —Ç–æ —Å–ª–µ–¥—É—é—â–∞—è —Ç–∞–±–ª–∏—á–Ω–∞—è —Ü–µ–Ω–∞ (0.5429) –±—É–¥–µ—Ç **—Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ** –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Ä–µ–∞–ª—å–Ω–æ–π —Ü–µ–Ω—ã (0.5729).

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü–æ–∫—É–ø–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ **–º–∞–ª–µ–Ω—å–∫–æ–º –ø–∞–¥–µ–Ω–∏–∏** –æ—Ç —Ä–µ–∞–ª—å–Ω–æ–π —Ü–µ–Ω—ã.

---

## üõ†Ô∏è –†–µ—à–µ–Ω–∏–µ

### –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ (—Ñ–∞–π–ª `autotrader_v2.py`):

```python
# üî• –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê: –†–µ–∞–ª—å–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å >= —Ç–∞–±–ª–∏—á–Ω–æ–º—É!
if last_buy_price > 0 and decrease_step_pct > 0:
    min_price_from_real = last_buy_price * (1 - decrease_step_pct / 100.0)
    # –ë–µ—Ä—ë–º –ú–ò–ù–ò–ú–£–ú –º–µ–∂–¥—É —Ç–∞–±–ª–∏—á–Ω–æ–π —Ü–µ–Ω–æ–π –∏ —Ä–∞—Å—á—ë—Ç–Ω–æ–π –æ—Ç —Ä–µ–∞–ª—å–Ω–æ–π
    rebuy_threshold = min(tabular_rate, min_price_from_real)
```

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

**–ü—Ä–∏–º–µ—Ä 1**: –ü—Ä–µ–¥—ã–¥—É—â–∞—è –ø–æ–∫—É–ø–∫–∞ **–≤—ã—à–µ** —Ç–∞–±–ª–∏—á–Ω–æ–π
```
–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Ä–µ–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞: 0.5729
–¢–∞–±–ª–∏—á–Ω–∞—è —Ü–µ–Ω–∞ —à–∞–≥–∞ 2: 0.5429
–¢–∞–±–ª–∏—á–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ: -3%
–ú–∏–Ω–∏–º—É–º –æ—Ç —Ä–µ–∞–ª—å–Ω–æ–π: 0.5729 √ó 0.97 = 0.5557

–ò—Ç–æ–≥–æ–≤—ã–π –ø–æ—Ä–æ–≥ = min(0.5429, 0.5557) = 0.5429 ‚úÖ
–ù–æ! –¶–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ —É–ø–∞—Å—Ç—å –¥–æ 0.5557, —á—Ç–æ–±—ã —Ä–µ–∞–ª—å–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ –±—ã–ª–æ -3%!
```

**–°—Ç–æ–ø!** –Ø –≤–∑—è–ª `min()`, –Ω–æ –Ω—É–∂–µ–Ω `max()`! –î–∞–≤–∞–π—Ç–µ –∏—Å–ø—Ä–∞–≤–∏–º:

---

## üîß –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

–ù—É–∂–Ω–æ –±—Ä–∞—Ç—å **–ú–ê–ö–°–ò–ú–£–ú**, —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –±–æ–ª—å—à–µ –ø–∞–¥–µ–Ω–∏–µ:

```python
rebuy_threshold = max(tabular_rate, min_price_from_real)
```

–ù–æ —ç—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç! –ï—Å–ª–∏ –≤–∑—è—Ç—å max, —Ç–æ –ø–æ—Ä–æ–≥ –±—É–¥–µ—Ç **–≤—ã—à–µ**, –∏ –ø–æ–∫—É–ø–∫–∞ –≤–æ–æ–±—â–µ –Ω–µ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç.

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ**: –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å **–û–ë–ê —É—Å–ª–æ–≤–∏—è**:
1. –¶–µ–Ω–∞ <= —Ç–∞–±–ª–∏—á–Ω–æ–π —Ü–µ–Ω—ã
2. –†–µ–∞–ª—å–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ >= —Ç–∞–±–ª–∏—á–Ω–æ–≥–æ –ø–∞–¥–µ–Ω–∏—è

---

## ‚úÖ –§–∏–Ω–∞–ª—å–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

```python
# –£—Å–ª–æ–≤–∏–µ 1: –¶–µ–Ω–∞ –¥–æ—Å—Ç–∏–≥–ª–∞ —Ç–∞–±–ª–∏—á–Ω–æ–π
if price >= tabular_rate:
    return

# –£—Å–ª–æ–≤–∏–µ 2: –†–µ–∞–ª—å–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ >= —Ç–∞–±–ª–∏—á–Ω–æ–≥–æ
if last_buy_price > 0 and decrease_step_pct > 0:
    min_price_for_real_drop = last_buy_price * (1 - decrease_step_pct / 100.0)
    if price >= min_price_for_real_drop:
        print(f"[{base}] [BLOCK] –†–µ–∞–ª—å–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ!")
        print(f"[{base}]   –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞: {price:.8f}")
        print(f"[{base}]   –ù—É–∂–Ω–æ —É–ø–∞—Å—Ç—å –¥–æ: {min_price_for_real_drop:.8f}")
        print(f"[{base}]   –î–ª—è –ø–∞–¥–µ–Ω–∏—è –Ω–∞: {decrease_step_pct:.2f}%")
        return
```

–°–µ–π—á–∞—Å –∏—Å–ø—Ä–∞–≤–ª—é –∫–æ–¥ –ø—Ä–∞–≤–∏–ª—å–Ω–æ!
