# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ê –ü–†–û–ë–õ–ï–ú–ê: –î–≤–µ —Å—Ç–∞—Ä—Ç–æ–≤—ã–µ –ø–æ–∫—É–ø–∫–∏ –ø–æ–¥—Ä—è–¥

## –ü—Ä–æ–±–ª–µ–º–∞
–ò–Ω–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–∏ –¥–≤–µ —Å—Ç–∞—Ä—Ç–æ–≤—ã–µ –ø–æ–∫—É–ø–∫–∏ –ø–æ–¥—Ä—è–¥ —Å —Ä–∞–∑–Ω–∏—Ü–µ–π –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥:
```
[13:41:25] [LTC] Buy{9.9675; –ö—É—Ä—Å:84.4700; ‚ÜìŒî%:0.00; ‚Üì%:0.00; –ò–Ω–≤–µ—Å—Ç:10.0000}
[13:41:29] [LTC] Buy{10.0329; –ö—É—Ä—Å:84.3100; ‚ÜìŒî%:0.00; ‚Üì%:0.00; –ò–Ω–≤–µ—Å—Ç:10.0329}
```

## –ü—Ä–∏—á–∏–Ω–∞: Race Condition (–ì–æ–Ω–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π)

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø–æ–∫—É–ø–∫–∏ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ:

```python
# –ë–´–õ–û (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û):
cycle['pending_start'] = False  # ‚Üê –°–±—Ä–æ—Å —Ñ–ª–∞–≥–∞
cycle['last_sell_time'] = 0
# ... –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ...
cycle.update({
    'active': True,  # ‚Üê –ê–∫—Ç–∏–≤–∞—Ü–∏—è —Ü–∏–∫–ª–∞
    'active_step': 0,
    ...
})
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –ú–µ–∂–¥—É —Å–±—Ä–æ—Å–æ–º `pending_start = False` –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π `active = True` –±—ã–ª–æ **"–æ–∫–Ω–æ –≥–æ–Ω–∫–∏"** –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥. –í —ç—Ç–æ –≤—Ä–µ–º—è –¥—Ä—É–≥–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è —Ü–∏–∫–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∞–ª—é—Ç –º–æ–≥–ª–∞:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `active` ‚Üí False (—Ü–∏–∫–ª –µ—â—ë –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω)
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `pending_start` ‚Üí False (—É–∂–µ —Å–±—Ä–æ—à–µ–Ω!)
3. –ù–∞—á–∞—Ç—å –≤—Ç–æ—Ä—É—é —Å—Ç–∞—Ä—Ç–æ–≤—É—é –ø–æ–∫—É–ø–∫—É

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

–ò–∑–º–µ–Ω—ë–Ω –ø–æ—Ä—è–¥–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π: **–°–ù–ê–ß–ê–õ–ê –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º —Ü–∏–∫–ª, –ü–û–¢–û–ú —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥**:

```python
# –°–¢–ê–õ–û (–ü–†–ê–í–ò–õ–¨–ù–û):
cycle.update({
    'active': True,  # ‚Üê –°–Ω–∞—á–∞–ª–∞ –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º —Ü–∏–∫–ª!
    'active_step': 0,
    ...
})

# ====== –°–ë–†–ê–°–´–í–ê–ï–ú –§–õ–ê–ì–ò –ó–ê–©–ò–¢–´ –ü–û–°–õ–ï –ê–ö–¢–ò–í–ê–¶–ò–ò –¶–ò–ö–õ–ê ======
cycle['pending_start'] = False  # ‚Üê –°–±—Ä–æ—Å —Ñ–ª–∞–≥–∞ –ü–û–°–õ–ï –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
cycle['last_sell_time'] = 0
```

–¢–µ–ø–µ—Ä—å:
1. –¶–∏–∫–ª —Å—Ä–∞–∑—É —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º (`active = True`)
2. –õ—é–±–∞—è –Ω–æ–≤–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∏—Ç `active` ‚Üí True
3. –í—Ç–æ—Ä–∞—è –ø–æ–∫—É–ø–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è: "—Ü–∏–∫–ª —É–∂–µ –∞–∫—Ç–∏–≤–µ–Ω"
4. –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `pending_start`

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –º–µ—Å—Ç–∞

### 1. autotrader.py, —Å—Ç—Ä–æ–∫–∞ ~1470 (–æ—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞)
```python
# ====== –ö–†–ò–¢–ò–ß–ù–û: –°–ù–ê–ß–ê–õ–ê –ê–ö–¢–ò–í–ò–†–£–ï–ú –¶–ò–ö–õ, –ü–û–¢–û–ú –°–ë–†–ê–°–´–í–ê–ï–ú –§–õ–ê–ì ======
cycle.update({
    'active': True,
    'active_step': 0,
    'last_buy_price': actual_buy_price,
    'start_price': actual_buy_price,
    'total_invested_usd': invest,
    'base_volume': filled
})

# ====== –°–ë–†–ê–°–´–í–ê–ï–ú –§–õ–ê–ì–ò –ó–ê–©–ò–¢–´ –ü–û–°–õ–ï –ê–ö–¢–ò–í–ê–¶–ò–ò –¶–ò–ö–õ–ê ======
cycle['pending_start'] = False
cycle['last_sell_time'] = 0
```

### 2. autotrader.py, —Å—Ç—Ä–æ–∫–∞ ~1084 (–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —á–∞—Å—Ç–∏—á–Ω–æ–π –ø–æ–∫—É–ø–∫–∏)
```python
# ====== –ö–†–ò–¢–ò–ß–ù–û: –°–ù–ê–ß–ê–õ–ê –ê–ö–¢–ò–í–ò–†–£–ï–ú –¶–ò–ö–õ, –ü–û–¢–û–ú –°–ë–†–ê–°–´–í–ê–ï–ú –§–õ–ê–ì ======
cycle.update({
    'active': True,
    'active_step': 0,
    'last_buy_price': start_price,
    'start_price': start_price,
    'total_invested_usd': total_usd,
    'base_volume': total_filled
})

# ====== –°–ë–†–ê–°–´–í–ê–ï–ú –§–õ–ê–ì–ò –ó–ê–©–ò–¢–´ –ü–û–°–õ–ï –ê–ö–¢–ò–í–ê–¶–ò–ò –¶–ò–ö–õ–ê ======
cycle['pending_start'] = False
cycle['last_sell_time'] = 0
```

## –ó–∞—â–∏—Ç–∞ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫:

### –ü–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞ –ø–æ–∫—É–ø–∫–∏:
1. `pending_start = True` ‚Üí –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏
2. –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–∫—É–ø–∫–∞
3. –ü–æ–∫—É–ø–∫–∞ —É—Å–ø–µ—à–Ω–∞ ‚Üí `active = True` (—Ü–∏–∫–ª –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω)
4. –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ ‚Üí `pending_start = False`

### –í—Ç–æ—Ä–∞—è –ø–æ–ø—ã—Ç–∫–∞ –ø–æ–∫—É–ø–∫–∏ (–≤ –¥—Ä—É–≥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ —Ü–∏–∫–ª–∞):
1. –ü—Ä–æ–≤–µ—Ä–∫–∞: `active = True` ‚Üí **–ë–õ–û–ö–ò–†–û–í–ö–ê!**
2. –í—ã–≤–æ–¥: "—Ü–∏–∫–ª —É–∂–µ –∞–∫—Ç–∏–≤–µ–Ω"
3. –ü–æ–∫—É–ø–∫–∞ –ù–ï –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è ‚úÖ

## –†–µ–∑—É–ª—å—Ç–∞—Ç
- ‚úÖ **–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ** —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ —Å—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞
- ‚úÖ –ù–µ—Ç "–æ–∫–Ω–∞ –≥–æ–Ω–∫–∏" –º–µ–∂–¥—É –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
- ‚úÖ –ê—Ç–æ–º–∞—Ä–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è —Ü–∏–∫–ª–∞
- ‚úÖ –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞—â–∏—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –∏ —Ä–∞–Ω—å—à–µ

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞:
1. –°–¥–µ–ª–∞–π—Ç–µ –ø—Ä–æ–¥–∞–∂—É –≤–∞–ª—é—Ç—ã
2. –°–±—Ä–æ—Å—å—Ç–µ —Ü–∏–∫–ª
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –¢–û–õ–¨–ö–û –û–î–ù–ê —Å—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞
4. –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
   ```
   [START_CYCLE][–≤–∞–ª—é—Ç–∞] ‚úÖ –£–°–ü–ï–®–ù–ê–Ø –ü–û–ö–£–ü–ö–ê
   [START_CYCLE][–≤–∞–ª—é—Ç–∞] üîÑ –¶–ò–ö–õ –ê–ö–¢–ò–í–ò–†–û–í–ê–ù: active=True
   ```
   **–ë–µ–∑ –ø–æ–≤—Ç–æ—Ä–æ–≤!**

## –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)
```powershell
python stop.py
python mTrade.py
```

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–±–ª–µ–º–∞ –¥–≤–æ–π–Ω—ã—Ö —Å—Ç–∞—Ä—Ç–æ–≤—ã—Ö –ø–æ–∫—É–ø–æ–∫ **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞**!
