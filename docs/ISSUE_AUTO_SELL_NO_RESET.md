# üî¥ –ù–û–í–ê–Ø –ü–†–û–ë–õ–ï–ú–ê: –ê–≤—Ç–æ–ø—Ä–æ–¥–∞–∂–∞ –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ü–∏–∫–ª

**–î–∞—Ç–∞:** 2025-12-04 16:30  
**–°—Ç–∞—Ç—É—Å:** üî¥ –û–ë–ù–ê–†–£–ñ–ï–ù–ê –ù–û–í–ê–Ø –ü–†–û–ë–õ–ï–ú–ê  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í–´–°–û–ö–ò–ô  

---

## üéØ –û–ü–ò–°–ê–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´

–ü–æ—Å–ª–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–¥–∞–∂–∏ **—Ü–∏–∫–ª –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è** –∏ –æ—Å—Ç–∞—ë—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º, —á—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç –Ω–æ–≤—É—é —Å—Ç–∞—Ä—Ç–æ–≤—É—é –ø–æ–∫—É–ø–∫—É.

### –ü—Ä–∏–º–µ—Ä –∏–∑ –ª–æ–≥–æ–≤ (ETH):

```
[16:21:20] [ETH] Sell{202.0621; –ö—É—Ä—Å:3182.0800; ‚ÜëŒî%:0.00; PnL:0.0000; –ü—Ä–æ—Ñ–∏—Ç:0.0000}
                 ‚Üë –ê–≤—Ç–æ–ø—Ä–æ–¥–∞–∂–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞

[15:58:19] [ETH] Buy{13.8352; –ö—É—Ä—Å:3144.3700; ‚ÜìŒî%:1.11; ‚Üì%:1.11; –ò–Ω–≤–µ—Å—Ç:13.8352}
[13:23:45] [ETH] Buy{10.1746; –ö—É—Ä—Å:3179.5700; ‚ÜìŒî%:0.00; ‚Üì%:0.00; –ò–Ω–≤–µ—Å—Ç:10.1746}
```

### –°–æ—Å—Ç–æ—è–Ω–∏–µ —Ü–∏–∫–ª–∞ –ü–û–°–õ–ï –ø—Ä–æ–¥–∞–∂–∏:

```json
"ETH": {
  "active": true,           ‚Üê –î–û–õ–ñ–ù–û –ë–´–¢–¨ false!
  "active_step": 1,         ‚Üê –î–û–õ–ñ–ù–û –ë–´–¢–¨ -1!
  "last_buy_price": 3144.37,
  "start_price": 3179.57,
  "total_invested_usd": 24.01,
  "base_volume": 0.0076,    ‚Üê –û—Å—Ç–∞—Ç–æ–∫ –ø–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏ (–ø—ã–ª—å)
  ...
}
```

## ‚ö†Ô∏è –ü–û–°–õ–ï–î–°–¢–í–ò–Ø

1. **–¶–∏–∫–ª –æ—Å—Ç–∞—ë—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º** ‚Üí –Ω–æ–≤–∞—è —Å—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞ –ù–ï –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
2. **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–æ–¥–∞–∂–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è** –≤ –ª–æ–≥–∞—Ö (PnL, –ø—Ä–æ—Ñ–∏—Ç –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç 0)
3. **–ë–∞–ª–∞–Ω—Å BASE –Ω–µ –æ–±–Ω—É–ª—è–µ—Ç—Å—è** (–æ—Å—Ç–∞—ë—Ç—Å—è ~0.0076 ETH = "–ø—ã–ª—å")
4. **–ê–≤—Ç–æ—Ç—Ä–µ–π–¥–µ—Ä —Å—á–∏—Ç–∞–µ—Ç**, —á—Ç–æ —Ü–∏–∫–ª –µ—â—ë –∏–¥—ë—Ç

## üîç –û–¢–õ–ò–ß–ò–ï –û–¢ –†–£–ß–ù–û–ô –ü–†–û–î–ê–ñ–ò

### –†—É—á–Ω–∞—è –ø—Ä–æ–¥–∞–∂–∞ (—Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ):

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "Sell All" ‚Üí –ø—Ä–æ–¥–∞–∂–∞
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "Reset Cycle" ‚Üí —Å–±—Ä–æ—Å
3. –¶–∏–∫–ª —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è: `active=false`, `active_step=-1`
4. –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è —Å—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞

### –ê–≤—Ç–æ–ø—Ä–æ–¥–∞–∂–∞ (–ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç):

1. –ê–≤—Ç–æ—Ç—Ä–µ–π–¥–µ—Ä –ø—Ä–æ–¥–∞—ë—Ç ‚Üí –ø—Ä–æ–¥–∞–∂–∞
2. **–ê–≤—Ç–æ—Å–±—Ä–æ—Å —Ü–∏–∫–ª–∞ –ù–ï –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç!** ‚Üê –ü–†–û–ë–õ–ï–ú–ê
3. –¶–∏–∫–ª –æ—Å—Ç–∞—ë—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º: `active=true`
4. –ù–æ–≤–∞—è —Å—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞ –ù–ï –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

## üîß –¢–†–ï–ë–£–ï–ú–û–ï –ü–û–í–ï–î–ï–ù–ò–ï

**–ü–æ—Å–ª–µ –ª—é–±–æ–π –ø—Ä–æ–¥–∞–∂–∏** (—Ä—É—á–Ω–æ–π –∏–ª–∏ –∞–≤—Ç–æ) –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:

```json
"ETH": {
  "active": false,          ‚Üê –¶–∏–∫–ª –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω
  "active_step": -1,        ‚Üê –®–∞–≥ —Å–±—Ä–æ—à–µ–Ω
  "last_buy_price": 0.0,
  "start_price": 0.0,
  "total_invested_usd": 0.0,
  "base_volume": 0.0,       ‚Üê –ë–∞–ª–∞–Ω—Å BASE –æ–±–Ω—É–ª—ë–Ω
  "last_sell_time": 1733320880,  ‚Üê –í—Ä–µ–º—è –ø—Ä–æ–¥–∞–∂–∏
  ...
}
```

–ò –∑–∞—Ç–µ–º –¥–æ–ª–∂–Ω–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è **–Ω–æ–≤–∞—è —Å—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞**.

## üìä –ì–î–ï –ò–°–ö–ê–¢–¨ –ü–†–û–ë–õ–ï–ú–£

### –í–µ—Ä–æ—è—Ç–Ω—ã–µ –º–µ—Å—Ç–∞ –≤ –∫–æ–¥–µ:

1. **–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∞–≤—Ç–æ–ø—Ä–æ–¥–∞–∂–∏** –≤ `autotrader.py`
   - –ò—â–∏—Ç–µ –ª–æ–≥–∏–∫—É –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ª–æ–≤–∏–π –ø—Ä–æ–¥–∞–∂–∏
   - –ò—â–∏—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–∞ –ø—Ä–æ–¥–∞–∂–∏
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –µ—Å—Ç—å –ª–∏ —Å–±—Ä–æ—Å —Ü–∏–∫–ª–∞ –ø–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏

2. **–§—É–Ω–∫—Ü–∏—è —Å–±—Ä–æ—Å–∞ —Ü–∏–∫–ª–∞**
   - –î–æ–ª–∂–Ω–∞ –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–¥–∞–∂–∏
   - –î–æ–ª–∂–Ω–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å `active=false`, `active_step=-1`
   - –î–æ–ª–∂–Ω–∞ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å `last_sell_time`

3. **–õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è "—É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–¥–∞–∂–∏"**
   - –í–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ–¥–∞–∂–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ–π —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –±–∞–ª–∞–Ω—Å BASE = 0
   - –ù–æ –æ—Å—Ç–∞—ë—Ç—Å—è "–ø—ã–ª—å" (0.0076 ETH), –∏ —Ü–∏–∫–ª –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã:

1. ‚ùì –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ª–∏ —Ñ—É–Ω–∫—Ü–∏—è —Å–±—Ä–æ—Å–∞ —Ü–∏–∫–ª–∞ –ø–æ—Å–ª–µ –∞–≤—Ç–æ–ø—Ä–æ–¥–∞–∂–∏?
2. ‚ùì –ï—Å—Ç—å –ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ "–ø–æ–ª–Ω–æ–π –ø—Ä–æ–¥–∞–∂–∏" (–±–∞–ª–∞–Ω—Å BASE = 0)?
3. ‚ùì –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å "–ø—ã–ª—å—é" –ø–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏?
4. ‚ùì –ü–æ—á–µ–º—É `PnL:0.0000; –ü—Ä–æ—Ñ–∏—Ç:0.0000` –≤ –ª–æ–≥–∞—Ö?

## üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê

### –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑ —Ü–∏–∫–ª–∞ ETH:

```bash
python diagnose_double_start_buy.py --analyze-state --base ETH
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å–±—Ä–æ—Å–∞:

–ò—Å–∫–∞—Ç—å –≤ –ª–æ–≥–∞—Ö —Å–µ—Ä–≤–µ—Ä–∞:
```
[ETH] Sell ... –ü—Ä–æ—Ñ–∏—Ç:...
[ETH] –¶–∏–∫–ª —Å–±—Ä–æ—à–µ–Ω  ‚Üê –≠—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å!
[ETH] last_sell_time —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
```

–ï—Å–ª–∏ —Ç–∞–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ—Ç ‚Üí —Å–±—Ä–æ—Å –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è.

## üõ†Ô∏è –í–û–ó–ú–û–ñ–ù–û–ï –†–ï–®–ï–ù–ò–ï

### –í–∞—Ä–∏–∞–Ω—Ç 1: –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Å–±—Ä–æ—Å –ø–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏

–í —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞–≤—Ç–æ–ø—Ä–æ–¥–∞–∂–∏ –¥–æ–±–∞–≤–∏—Ç—å:

```python
# –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–¥–∞–∂–∏
if sell_order_success:
    # –°–±—Ä–æ—Å–∏—Ç—å —Ü–∏–∫–ª
    cycle['active'] = False
    cycle['active_step'] = -1
    cycle['last_buy_price'] = 0.0
    cycle['start_price'] = 0.0
    cycle['total_invested_usd'] = 0.0
    cycle['base_volume'] = 0.0
    cycle['last_sell_time'] = time.time()
    cycle['pending'] = {}
    
    self.cycles[base] = cycle
    self._save_cycles_state()
    
    print(f"[AUTO_SELL][{base}] –¶–∏–∫–ª —Å–±—Ä–æ—à–µ–Ω –ø–æ—Å–ª–µ –∞–≤—Ç–æ–ø—Ä–æ–¥–∞–∂–∏")
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å "–ø—ã–ª—å"

–ï—Å–ª–∏ –±–∞–ª–∞–Ω—Å BASE < 1% –æ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –ø–æ–∫—É–ø–∫–∏ ‚Üí —Å—á–∏—Ç–∞—Ç—å –µ–≥–æ "–ø—ã–ª—å—é" –∏ —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å —Ü–∏–∫–ª:

```python
if base_balance < min_purchase * 0.01:
    # –≠—Ç–æ –ø—ã–ª—å, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Ü–∏–∫–ª
    cycle['active'] = False
    cycle['active_step'] = -1
    # ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
```

## üìã –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### –°–µ–π—á–∞—Å (–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ):

1. **–í—Ä—É—á–Ω—É—é —Å–±—Ä–æ—Å–∏—Ç—å —Ü–∏–∫–ª ETH:**
   - UI ‚Üí ETH ‚Üí "Reset Cycle"
   - –≠—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç –Ω–æ–≤—É—é —Å—Ç–∞—Ä—Ç–æ–≤—É—é –ø–æ–∫—É–ø–∫—É

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—Ä—É–≥–∏–µ –≤–∞–ª—é—Ç—ã:**
   ```bash
   python diagnose_double_start_buy.py --analyze-state
   ```
   –ò—Å–∫–∞—Ç—å —Ü–∏–∫–ª—ã —Å `active=true` –∏ –º–∞–ª–µ–Ω—å–∫–∏–º `base_volume`

### –ü–æ—Ç–æ–º (–ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ):

1. –ù–∞–π—Ç–∏ –∫–æ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞–≤—Ç–æ–ø—Ä–æ–¥–∞–∂–∏
2. –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Å–±—Ä–æ—Å —Ü–∏–∫–ª–∞ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–¥–∞–∂–∏
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ü–∏–∫–ª–∞—Ö
4. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –Ω–æ–≤—ã–π —Ü–∏–∫–ª –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

## ‚ö†Ô∏è –í–ó–ê–ò–ú–û–°–í–Ø–ó–¨ –° –î–í–û–ô–ù–´–ú–ò –ü–û–ö–£–ü–ö–ê–ú–ò

–≠—Ç–∞ –ø—Ä–æ–±–ª–µ–º–∞ **–ù–ï —Å–≤—è–∑–∞–Ω–∞** —Å –ø—Ä–æ–±–ª–µ–º–æ–π –¥–≤–æ–π–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫:

- **–î–≤–æ–π–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏** = race condition –ø—Ä–∏ –°–¢–ê–†–¢–ï —Ü–∏–∫–ª–∞
- **–ù–µ–∑–∞–±—Ä–æ—à–µ–Ω–Ω—ã–π —Ü–∏–∫–ª** = –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞–≤—Ç–æ—Å–±—Ä–æ—Å–∞ –ø—Ä–∏ –ó–ê–í–ï–†–®–ï–ù–ò–ò —Ü–∏–∫–ª–∞

–≠—Ç–æ –¥–≤–µ **—Ä–∞–∑–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã**, —Ç—Ä–µ–±—É—é—â–∏–µ **—Ä–∞–∑–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π**.

## üìù –í–†–ï–ú–ï–ù–ù–û–ï –†–ï–®–ï–ù–ò–ï (–°–ï–ô–ß–ê–°)

**–î–ª—è ETH –∏ –¥—Ä—É–≥–∏—Ö "–∑–∞—Å—Ç—Ä—è–≤—à–∏—Ö" —Ü–∏–∫–ª–æ–≤:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Ü–∏–∫–ª—ã
python diagnose_double_start_buy.py --analyze-state

# –ò—Å–∫–∞—Ç—å: active=true + –º–∞–ª–µ–Ω—å–∫–∏–π base_volume
# –≠—Ç–æ "–∑–∞—Å—Ç—Ä—è–≤—à–∏–µ" —Ü–∏–∫–ª—ã –ø–æ—Å–ª–µ –∞–≤—Ç–æ–ø—Ä–æ–¥–∞–∂–∏

# –í—Ä—É—á–Ω—É—é —Å–±—Ä–æ—Å–∏—Ç—å —á–µ—Ä–µ–∑ UI:
# 1. –û—Ç–∫—Ä—ã—Ç—å UI
# 2. –í—ã–±—Ä–∞—Ç—å –≤–∞–ª—é—Ç—É
# 3. –ù–∞–∂–∞—Ç—å "Reset Cycle"
```

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù–∞–π—Ç–∏ –∫–æ–¥ –∞–≤—Ç–æ–ø—Ä–æ–¥–∞–∂–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Å–±—Ä–æ—Å —Ü–∏–∫–ª–∞.

**–°—Ç–∞—Ç—É—Å:** üî¥ –¢—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
