# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–ò–ú–ï–ù–ï–ù–û –£–°–ü–ï–®–ù–û!

## üìù –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∫–æ–¥ –¥–ª—è SELL (–ø—Ä–æ–¥–∞–∂–∞)
**–§–∞–π–ª:** `autotrader.py`, —Å—Ç—Ä–æ–∫–∏ ~2395-2415

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ `last_buy_price` –ø–µ—Ä–µ–¥ —Ä–∞—Å—á–µ—Ç–æ–º –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤
- ‚úÖ Fallback –Ω–∞ `start_price`, –µ—Å–ª–∏ `last_buy_price == 0`
- ‚úÖ Fallback –Ω–∞ `actual_exec_price`, –µ—Å–ª–∏ `start_price == 0`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ `base_volume` –∏ `total_invested_usd` –ø–µ—Ä–µ–¥ —Ä–∞—Å—á–µ—Ç–æ–º PnL
- ‚úÖ Fallback –¥–ª—è `avg_invest_price` –ø—Ä–∏ –Ω—É–ª–µ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö
- ‚úÖ WARNING —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∫–æ–¥ –¥–ª—è REBUY (–¥–æ–∫—É–ø–∫–∞)
**–§–∞–π–ª:** `autotrader.py`, —Å—Ç—Ä–æ–∫–∏ ~1820-1845

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ `last_buy` –ø–µ—Ä–µ–¥ —Ä–∞—Å—á–µ—Ç–æ–º stepwise –ø–∞–¥–µ–Ω–∏—è
- ‚úÖ Fallback –Ω–∞ `start_price`, –µ—Å–ª–∏ `last_buy == 0`
- ‚úÖ Fallback –Ω–∞ `level_price`, –µ—Å–ª–∏ `start_price == 0`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ `start_price` –ø–µ—Ä–µ–¥ —Ä–∞—Å—á–µ—Ç–æ–º cumulative –ø–∞–¥–µ–Ω–∏—è
- ‚úÖ WARNING —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- ‚úÖ –û—Ç–ª–∞–¥–æ—á–Ω—ã–π –≤—ã–≤–æ–¥ —Å —Ä–∞—Å—á–µ—Ç–∞–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –ª–æ–≥–æ–≤:

1. **–î–ª—è SELL:**
   - –ï—Å–ª–∏ `last_buy_price == 0` ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `start_price` –∏–ª–∏ `actual_exec_price`
   - –ï—Å–ª–∏ `base_volume == 0` –∏–ª–∏ `total_invested_usd == 0` ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback –¥–ª—è PnL
   - –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–∏—Ç—É–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å WARNING

2. **–î–ª—è REBUY:**
   - –ï—Å–ª–∏ `last_buy == 0` ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `start_price` –∏–ª–∏ `level_price`
   - –ï—Å–ª–∏ `start_price == 0` ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `level_price`
   - –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–∏—Ç—É–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å WARNING

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ autotrader.py
```bash
python autotrader.py
```

### 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤

**–ü—Ä–∏ –ø—Ä–æ–¥–∞–∂–µ –±—É–¥–µ—Ç–µ –≤–∏–¥–µ—Ç—å:**
```
[SELL_DEBUG][ETH] cycle data: last_buy_price=2996.98, total_invested_usd=20.43, base_volume=0.01130000
[SELL_DEBUG][ETH] CALCULATED WITH PROTECTION: delta=0.04%, avg_price=1807.69, pnl=13.42
[AutoTrader][ETH] ‚úÖ SELL FILLED: 0.01130000 ETH in 245ms, PnL=$13.42
```

**–ü—Ä–∏ –¥–æ–∫—É–ø–∫–µ –±—É–¥–µ—Ç–µ –≤–∏–¥–µ—Ç—å:**
```
[REBUY_DEBUG][ETH] CALCULATED WITH PROTECTION: step_drop=0.75%, cumulative_drop=0.75%
[AutoTrader][ETH] ‚úÖ BUY FILLED: 0.00340000 ETH in 198ms
```

**–ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã, —É–≤–∏–¥–∏—Ç–µ WARNING:**
```
[AutoTrader][ETH] ‚ö†Ô∏è  WARNING: last_buy_price is ZERO during SELL! Cycle may be corrupted.
[AutoTrader][ETH]    Attempting to use start_price=2996.98 as fallback
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π —Å–¥–µ–ª–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
- ‚úÖ –ó–Ω–∞—á–µ–Ω–∏—è `‚ÜìŒî%`, `‚ÜëŒî%` –∏ `PnL` **–ù–ï —Ä–∞–≤–Ω—ã –Ω—É–ª—é**
- ‚úÖ –ù–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö WARNING —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –õ–æ–≥–∏ –≤ `trade_logs/` —Å–æ–¥–µ—Ä–∂–∞—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

### 4. –ï—Å–ª–∏ –ø–æ—è–≤–ª—è—é—Ç—Å—è WARNING

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É:
```bash
python diagnose_zero_logs.py
```

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å state files:
```bash
python fix_cycles_prices.py
```

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:** ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω, –æ—à–∏–±–æ–∫ –Ω–µ—Ç
**–ò–∑–º–µ–Ω–µ–Ω–∏—è:** ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ
**–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è:** ‚ö†Ô∏è –ù–µ —Å–æ–∑–¥–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ–π–¥–µ—Ç –Ω–µ —Ç–∞–∫, –º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ git –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –≤—Ä—É—á–Ω—É—é:
```bash
copy autotrader.py autotrader.py.backup_manual
```

## üéâ –ì–æ—Ç–æ–≤–æ!

–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã. –¢–µ–ø–µ—Ä—å `autotrader.py` –∏–º–µ–µ—Ç –∑–∞—â–∏—Ç—É –æ—Ç –Ω—É–ª–µ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –ª–æ–≥–∞—Ö!

**–î–∞—Ç–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:** 02.12.2025, 22:00  
**–í–µ—Ä—Å–∏—è:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω—É–ª–µ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π v1.0
