# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ü–û–†–û–ì–ê –î–û–ö–£–ü–ö–ò - –§–ò–ù–ê–õ

## üî¥ –ü–†–û–ë–õ–ï–ú–ê –û–ë–ù–ê–†–£–ñ–ï–ù–ê

–ê–≤—Ç–æ—Ç—Ä–µ–π–¥–µ—Ä V2 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥** –¥–ª—è –¥–æ–∫—É–ø–∫–∏, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª –¥–∞–Ω–Ω—ã–º, –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã–º –Ω–∞ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–µ.

### –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ:

**–ù–∞ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–µ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):**
```
–°–ª–µ–¥. –ø–æ–∫—É–ø–∫–∞: 3,185.16 USDT
```
–†–∞—Å—á—ë—Ç: `3208.58 * (1 - 0.73/100) = 3185.16`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `decrease_step_pct = 0.73%` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã breakeven

**–í –∞–≤—Ç–æ—Ç—Ä–µ–π–¥–µ—Ä–µ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):**
```python
rebuy_trigger_pct = 2.0  # –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ä–æ–≥ 2%
rebuy_threshold = last_buy_price * (1.0 - rebuy_trigger_pct / 100.0)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: 3208.58 * (1 - 2.0/100) = 3144.41 ‚ùå
```
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä `rebuy_trigger_pct = 2%`

### –ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞?

1. **–¢–∞–±–ª–∏—Ü–∞ breakeven** —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π —Ñ–æ—Ä–º—É–ª–µ:
   ```
   decrease_step_pct = -((step √ó Rk) + R)
   ```
   –ì–¥–µ:
   - `step` - –Ω–æ–º–µ—Ä —à–∞–≥–∞
   - `Rk` - –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–æ—Å—Ç–∞ –æ–±—ä—ë–º–∞
   - `R` - —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ü–µ–Ω—Ç —Ä–æ—Å—Ç–∞

2. **`decrease_step_pct`** - —ç—Ç–æ **–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ** —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —à–∞–≥–∞–º–∏ –¥–æ–∫—É–ø–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ
3. **`rebuy_trigger_pct = 2%`** - —ç—Ç–æ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –ª–æ–≥–∏–∫—É —Ç–∞–±–ª–∏—Ü—ã

### –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:

- –ê–≤—Ç–æ—Ç—Ä–µ–π–¥–µ—Ä **–¥–æ–∫—É–ø–∞–ª —Å–ª–∏—à–∫–æ–º –ø–æ–∑–¥–Ω–æ** (–ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –Ω–∞ 2% –≤–º–µ—Å—Ç–æ 0.73%)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–µ–ª –Ω–∞ —ç–∫—Ä–∞–Ω–µ –æ–¥–Ω—É —Ü–µ–Ω—É –¥–æ–∫—É–ø–∫–∏, –Ω–æ –∞–≤—Ç–æ—Ç—Ä–µ–π–¥–µ—Ä –∂–¥–∞–ª –¥—Ä—É–≥—É—é
- **–ü–æ–ª–Ω–æ–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ UI –∏ –ª–æ–≥–∏–∫–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏!**

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `autotrader_v2.py`:

**–ë–´–õ–û (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):**
```python
# –®–ê–ì 2: –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ–∫—É–ø–∫–∏ (–ë–ï–ó lock)
params = self.state_manager.get_breakeven_params(base)
if not params:
    print(f"[{base}] [ERROR] –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã")
    return

rebuy_trigger_pct = float(params.get('rebuy_trigger_pct', 2.0))  # ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ!

# –®–ê–ì 3: –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ª–æ–≤–∏–µ –¥–æ–∫—É–ø–∫–∏
rebuy_threshold = last_buy_price * (1.0 - rebuy_trigger_pct / 100.0)
```

**–°–¢–ê–õ–û (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):**
```python
# –®–ê–ì 2: –ü–æ–ª—É—á–∞–µ–º –ø–æ—Ä–æ–≥ –¥–æ–∫—É–ø–∫–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã (–ë–ï–ó lock)
# –í–ê–ñ–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º decrease_step_pct –∏–∑ —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞ —Ç–∞–±–ª–∏—Ü—ã,
# –∞ –Ω–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π rebuy_trigger_pct –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤!
with lock:
    cycle = self.cycles[base]
    next_step_index = cycle.active_step + 1
    
    if next_step_index >= len(cycle.table):
        print(f"[{base}] [SKIP] –ù–µ—Ç —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ")
        return
    
    next_step = cycle.table[next_step_index]
    decrease_step_pct = abs(float(next_step.get('decrease_step_pct', 0)))

if decrease_step_pct <= 0:
    print(f"[{base}] [WARN] decrease_step_pct –∏–∑ —Ç–∞–±–ª–∏—Ü—ã = 0, –ø—Ä–æ–ø—É—Å–∫")
    return

# –®–ê–ì 3: –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ª–æ–≤–∏–µ –¥–æ–∫—É–ø–∫–∏
rebuy_threshold = last_buy_price * (1.0 - decrease_step_pct / 100.0)  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!
```

### –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å?

1. ‚úÖ **–ü–æ—Ä–æ–≥ –¥–æ–∫—É–ø–∫–∏ –±–µ—Ä—ë—Ç—Å—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã** (`decrease_step_pct` —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞)
2. ‚úÖ **–ü–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ UI –∏ –ª–æ–≥–∏–∫–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏**
3. ‚úÖ **–î–æ–∫—É–ø–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ—á–Ω–æ –≤ —Ç–æ—Ç –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–∞**

---

## üìä –ü–†–ò–ú–ï–† –†–ê–°–ß–Å–¢–ê

### ETH (—Ç–µ–∫—É—â–∏–π —Ü–∏–∫–ª):

**–î–∞–Ω–Ω—ã–µ:**
- –ü–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–∫—É–ø–∫–∞: `3208.58 USDT`
- –¢–µ–∫—É—â–∏–π —à–∞–≥: `0`
- –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: `1`
- `decrease_step_pct` —à–∞–≥–∞ 1: `0.73%` (–∏–∑ —Ç–∞–±–ª–∏—Ü—ã)

**–†–∞—Å—á—ë—Ç –ø–æ—Ä–æ–≥–∞ –¥–æ–∫—É–ø–∫–∏:**
```
rebuy_threshold = 3208.58 * (1 - 0.73/100)
rebuy_threshold = 3208.58 * 0.9927
rebuy_threshold = 3185.16 USDT ‚úÖ
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏—è:**
```
–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞: 3177.22 USDT
–ü–æ—Ä–æ–≥ –¥–æ–∫—É–ø–∫–∏:  3185.16 USDT
–£—Å–ª–æ–≤–∏–µ: 3177.22 < 3185.16 ? ‚Üí –ù–ï–¢ (–µ—â—ë –Ω–µ –¥–æ—Å—Ç–∏–≥–ª–∏)
```

**–ö–æ–≥–¥–∞ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –¥–æ–∫—É–ø–∫–∞:**
- –ö–∞–∫ —Ç–æ–ª—å–∫–æ —Ü–µ–Ω–∞ —É–ø–∞–¥—ë—Ç –¥–æ **3185.16 USDT** –∏–ª–∏ –Ω–∏–∂–µ
- –≠—Ç–æ —Ç–æ—á–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—é "–°–ª–µ–¥. –ø–æ–∫—É–ø–∫–∞" –Ω–∞ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–µ

---

## üîç –ü–†–û–í–ï–†–ö–ê –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### –®–∞–≥–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä:**
   ```bash
   python mTrade.py
   ```

2. **–û—Ç–∫—Ä—ã—Ç—å –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—É** –∏ –Ω–∞–π—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–µ "–°–ª–µ–¥. –ø–æ–∫—É–ø–∫–∞" –¥–ª—è ETH

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏** –∞–≤—Ç–æ—Ç—Ä–µ–π–¥–µ—Ä–∞:
   ```
   [ETH] üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏—è –¥–æ–∫—É–ø–∫–∏:
   [ETH]   –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞: 3177.22000000
   [ETH]   –ü–æ—Å–ª–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏: 3208.58000000
   [ETH]   –ü–æ—Ä–æ–≥ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã (-0.73%): 3185.16000000  ‚Üê –î–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å UI!
   [ETH]   –£—Å–ª–æ–≤–∏–µ: 3177.22000000 < 3185.16000000 ?
   ```

4. **–£–±–µ–¥–∏—Ç—å—Å—è**, —á—Ç–æ –ø–æ—Ä–æ–≥ –≤ –ª–æ–≥–∞—Ö —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å "–°–ª–µ–¥. –ø–æ–∫—É–ø–∫–∞" –Ω–∞ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–µ

---

## ‚úÖ –ò–¢–û–ì

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
- ‚úÖ –ê–≤—Ç–æ—Ç—Ä–µ–π–¥–µ—Ä —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `decrease_step_pct` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –ø–æ—Ä–æ–≥–∞ –¥–æ–∫—É–ø–∫–∏
- ‚úÖ –ü–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É UI –∏ —Ç–æ—Ä–≥–æ–≤–æ–π –ª–æ–≥–∏–∫–æ–π
- ‚úÖ –î–æ–∫—É–ø–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ—á–Ω–æ –∫–æ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–∞

### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:
- `autotrader_v2.py` - —Ñ—É–Ω–∫—Ü–∏—è `_try_rebuy()` (—Å—Ç—Ä–æ–∫–∏ ~945-970)

### –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–æ—Ä–æ–≥–æ–≤

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 11 –¥–µ–∫–∞–±—Ä—è 2025 –≥.
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û, –ì–û–¢–û–í–û –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ
