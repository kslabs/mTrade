# ‚úÖ –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞ –≤—Å–µ—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

## üéØ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á—ë—Ç –ø—Ä–æ—Ñ–∏—Ç–∞ –ø—Ä–∏ –ø—Ä–æ–¥–∞–∂–µ**
- ‚úÖ –ü—Ä–∏ –ø–æ–∫—É–ø–∫–µ "–ò–Ω–≤–µ—Å—Ç" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç **–ù–ê–ö–û–ü–ò–¢–ï–õ–¨–ù–£–Æ** —Å—É–º–º—É –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π
- ‚úÖ –ü—Ä–∏ –ø—Ä–æ–¥–∞–∂–µ –ø—Ä–æ—Ñ–∏—Ç = (—Å—É–º–º–∞ –æ—Ç –ø—Ä–æ–¥–∞–∂–∏) - (—Å—É–º–º–∞ –≤—Å–µ—Ö –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –≤ —Ü–∏–∫–ª–µ)
- ‚úÖ –ü–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –æ–±–Ω—É–ª—è—é—Ç—Å—è (–≥–æ—Ç–æ–≤—ã –∫ –Ω–æ–≤–æ–º—É —Ü–∏–∫–ª—É)

### 2. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ total_invested –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ**
- ‚úÖ –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ª–æ–≥–æ–≤ –∏–∑ —Ñ–∞–π–ª–∞ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è —Å—É–º–º–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π
- ‚úÖ –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è —Å—É–º–º–∞ –Ω–µ —Ç–µ—Ä—è–µ—Ç—Å—è

### 3. **–†–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–∞–¥–µ–Ω–∏—è —Ü–µ–Ω—ã**
- ‚úÖ `‚ÜìŒî%` (delta_percent) = —Ä–µ–∞–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã –æ—Ç —Å—Ç–∞—Ä—Ç–æ–≤–æ–π
- ‚úÖ `‚Üì%` (total_drop_percent) = `abs(delta_percent)` - —Ç–æ –∂–µ —Å–∞–º–æ–µ –ø–æ –º–æ–¥—É–ª—é
- ‚úÖ –¢–µ–ø–µ—Ä—å –∑–Ω–∞—á–µ–Ω–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø–æ –º–æ–¥—É–ª—é (–ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–µ–∞–ª—å–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ)

## üìù –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### `trade_logger.py`

#### 1. –ú–µ—Ç–æ–¥ `log_buy` - –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è —Å—É–º–º–∞
```python
# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ù–ê–ö–û–ü–ò–¢–ï–õ–¨–ù–£–Æ —Å—É–º–º—É –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π
print(f"...–ò–Ω–≤–µ—Å—Ç:{self.total_invested[currency]:.4f}}}")
```

#### 2. –ú–µ—Ç–æ–¥ `log_sell` - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏—Ç
```python
# –ü—Ä–æ—Ñ–∏—Ç = (—Å—É–º–º–∞ –æ—Ç –ø—Ä–æ–¥–∞–∂–∏) - (—Å—É–º–º–∞ –≤—Å–µ—Ö –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –≤ —Ü–∏–∫–ª–µ)
cycle_profit = volume_quote - self.total_invested[currency]

# –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—É–º–º—É –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –¥–æ –æ–±–Ω—É–ª–µ–Ω–∏—è
total_invested_before = self.total_invested[currency]

# –ü–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏ –æ–±–Ω—É–ª—è–µ–º –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏
self.total_invested[currency] = 0.0
```

#### 3. –ú–µ—Ç–æ–¥ `_load_logs_for_currency` - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ total_invested
```python
# –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—É—é —Å—É–º–º—É –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –∏–∑ –ª–æ–≥–æ–≤
total_invested = 0.0
for entry in logs:
    if entry.get('type') == 'buy':
        total_invested = entry.get('total_invested', 0.0)
    elif entry.get('type') == 'sell':
        total_invested = 0.0  # –ü–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏ –æ–±–Ω—É–ª—è–µ—Ç—Å—è

self.total_invested[currency] = total_invested
```

### `autotrader_v2.py`

#### –ú–µ—Ç–æ–¥ `_try_rebuy` - —Ä–µ–∞–ª—å–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ —Ü–µ–Ω—ã
```python
# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –†–ï–ê–õ–¨–ù–û–ï –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã –æ—Ç —Å—Ç–∞—Ä—Ç–æ–≤–æ–π
if start_price > 0:
    delta_percent = ((executed_price - start_price) / start_price) * 100.0
else:
    delta_percent = 0.0

# total_drop_percent = —Ä–µ–∞–ª—å–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ (—Ç–æ –∂–µ —á—Ç–æ delta_percent –ø–æ –º–æ–¥—É–ª—é)
actual_total_drop_pct = abs(delta_percent)
```

## üí° –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ü—Ä–∏–º–µ—Ä —Ü–∏–∫–ª–∞:

#### –ü–æ–∫—É–ø–∫–∞ 1 (—Å—Ç–∞—Ä—Ç–æ–≤–∞—è)
```
[16:28:52] [ETH] Buy{9.8195; –ö—É—Ä—Å:3167.5700; ‚ÜìŒî%:0.00; ‚Üì%:0.00; –ò–Ω–≤–µ—Å—Ç:9.8195}
```
- –°—Ç–∞—Ä—Ç–æ–≤–∞—è —Ü–µ–Ω–∞: 3167.57
- –°—É–º–º–∞ –ø–æ–∫—É–ø–∫–∏: 9.8195 USDT
- **–ò–Ω–≤–µ—Å—Ç:** 9.8195 USDT (–Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è)
- ‚ÜìŒî%: 0.00 (—Å—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞)
- ‚Üì%: 0.00 (—Å—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞)

#### –ü–æ–∫—É–ø–∫–∞ 2 (–¥–æ–∫—É–ø–∫–∞)
```
[16:34:09] [ETH] Buy{13.5358; –ö—É—Ä—Å:3147.8600; ‚ÜìŒî%:-0.62; ‚Üì%:0.62; –ò–Ω–≤–µ—Å—Ç:23.3553}
```
- –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞: 3147.86
- –°—É–º–º–∞ –ø–æ–∫—É–ø–∫–∏: 13.5358 USDT
- **–ò–Ω–≤–µ—Å—Ç:** 23.3553 USDT (9.8195 + 13.5358) ‚Üê –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è
- ‚ÜìŒî%: -0.62% (—Ü–µ–Ω–∞ —É–ø–∞–ª–∞ –Ω–∞ 0.62% –æ—Ç —Å—Ç–∞—Ä—Ç–æ–≤–æ–π)
- ‚Üì%: 0.62% (—Ä–µ–∞–ª—å–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ = abs(-0.62))

#### –ü—Ä–æ–¥–∞–∂–∞
```
[17:00:00] [ETH] Sell{25.8000; –ö—É—Ä—Å:3200.0000; ‚ÜëŒî%:1.02; –ü—Ä–æ—Ñ–∏—Ç:2.4447; –ò–Ω–≤–µ—Å—Ç:23.3553}
```
- –°—É–º–º–∞ –ø—Ä–æ–¥–∞–∂–∏: 25.8000 USDT
- **–ü—Ä–æ—Ñ–∏—Ç:** 2.4447 USDT (25.8000 - 23.3553) ‚Üê —Ä–µ–∞–ª—å–Ω–∞—è –ø—Ä–∏–±—ã–ª—å —Ü–∏–∫–ª–∞
- **–ò–Ω–≤–µ—Å—Ç:** 23.3553 USDT ‚Üê –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–∫–æ–ª—å–∫–æ –±—ã–ª–æ –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ
- –ü–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏: total_invested –æ–±–Ω—É–ª—è–µ—Ç—Å—è

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

- ‚úÖ "–ò–Ω–≤–µ—Å—Ç" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—É—é —Å—É–º–º—É –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π
- ‚úÖ "–ü—Ä–æ—Ñ–∏—Ç" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é –ø—Ä–∏–±—ã–ª—å —Ü–∏–∫–ª–∞
- ‚úÖ ‚ÜìŒî% –∏ ‚Üì% –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø–æ –º–æ–¥—É–ª—é)
- ‚úÖ –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è —Å—É–º–º–∞ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
- ‚úÖ –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –ª–æ–≥–∏—á–Ω—ã –∏ –ø–æ–Ω—è—Ç–Ω—ã

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –î–æ/–ü–æ—Å–ª–µ

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
[16:28:52] [ETH] Buy{9.8195; –ö—É—Ä—Å:3167.5700; ‚ÜìŒî%:0.00; ‚Üì%:0.00; –ò–Ω–≤–µ—Å—Ç:9.8195}
[16:34:09] [ETH] Buy{13.5358; –ö—É—Ä—Å:3147.8600; ‚ÜìŒî%:-0.62; ‚Üì%:0.73; –ò–Ω–≤–µ—Å—Ç:13.5358}
                                                                    ^^^^^^^^ –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (–Ω–µ –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç—Å—è)
                                                          ^^^^^ –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (–∏–∑ —Ç–∞–±–ª–∏—Ü—ã, –Ω–µ —Ä–µ–∞–ª—å–Ω–æ–µ)
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
[16:28:52] [ETH] Buy{9.8195; –ö—É—Ä—Å:3167.5700; ‚ÜìŒî%:0.00; ‚Üì%:0.00; –ò–Ω–≤–µ—Å—Ç:9.8195}
[16:34:09] [ETH] Buy{13.5358; –ö—É—Ä—Å:3147.8600; ‚ÜìŒî%:-0.62; ‚Üì%:0.62; –ò–Ω–≤–µ—Å—Ç:23.3553}
                                                           ^^^^ –ü–†–ê–í–ò–õ–¨–ù–û (—Ä–µ–∞–ª—å–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ)
                                                                     ^^^^^^^^ –ü–†–ê–í–ò–õ–¨–ù–û (–Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è)
```

---

**–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω—ã!** ‚úÖ  
**–§–∞–π–ª—ã:** `trade_logger.py`, `autotrader_v2.py`  
**–î–∞—Ç–∞:** 2025-12-12

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ä–µ–∞–ª—å–Ω–∞—è –ø–æ–∫—É–ø–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–∞–±–ª–∏—Ü–µ (–æ—Ç–¥–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞)
