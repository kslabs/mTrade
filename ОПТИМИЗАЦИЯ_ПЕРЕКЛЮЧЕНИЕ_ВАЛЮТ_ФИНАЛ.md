# ‚úÖ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø: –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∞–ª—é—Ç

**–î–∞—Ç–∞:** 18 –¥–µ–∫–∞–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û  
**–¶–µ–ª—å:** –£—Å–∫–æ—Ä–∏—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∞–ª—é—Ç —Å 10-20 —Å–µ–∫—É–Ω–¥ –¥–æ 1-2 —Å–µ–∫—É–Ω–¥

---

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∞–ª—é—Ç —É—Å–∫–æ—Ä–∏–ª–æ—Å—å —Å –º–∏–Ω—É—Ç –¥–æ 10-20 —Å–µ–∫—É–Ω–¥, –Ω–æ —ç—Ç–æ –≤—Å—ë –µ—â—ë –º–µ–¥–ª–µ–Ω–Ω–æ. 

### –ù–∞–π–¥–µ–Ω–Ω—ã–µ —É–∑–∫–∏–µ –º–µ—Å—Ç–∞:

1. **–ó–∞–¥–µ—Ä–∂–∫–∞ 500–º—Å** –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –¥–∞–Ω–Ω—ã—Ö (`await new Promise(resolve => setTimeout(resolve, 500))`)
2. **–ë–ª–æ–∫–∏—Ä—É—é—â–∏–π await** –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É WebSocket
3. **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ** —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ UI state (–±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ)

---

## üöÄ –†–µ—à–µ–Ω–∏–µ

### 1. –£–±—Ä–∞–ª–∏ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏
```javascript
// –ë–´–õ–û:
await subscribeToPairData(currentBaseCurrency, currentQuoteCurrency);
await new Promise(resolve => setTimeout(resolve, 500)); // ‚ùå –ó–∞–¥–µ—Ä–∂–∫–∞ 500–º—Å
await loadMarketData(true);
// ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–≥—Ä—É–∑–∫–∏

// –°–¢–ê–õ–û:
subscribeToPairData(currentBaseCurrency, currentQuoteCurrency).catch(...); // ‚úÖ –ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–π –∑–∞–ø—É—Å–∫
// –°—Ä–∞–∑—É –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
await Promise.all([
  loadMarketData(true),
  loadPairBalances(),
  // ...
]);
```

### 2. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ UI state –≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å
```javascript
// –ë–´–õ–û:
await Promise.all(loadPromises); // –ñ–¥—ë–º –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
await UIStateManager.savePartial({...}); // –ü–æ—Ç–æ–º —Å–æ—Ö—Ä–∞–Ω—è–µ–º state

// –°–¢–ê–õ–û:
loadPromises.push(UIStateManager.savePartial({...})); // ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
await Promise.all(loadPromises);
```

### 3. –ü—Ä–∏–º–µ–Ω–∏–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –≤–µ–∑–¥–µ
- ‚úÖ `switchBaseCurrency()` - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç—ã
- ‚úÖ `changeQuoteCurrency()` - —Å–º–µ–Ω–∞ –∫–æ—Ç–∏—Ä—É–µ–º–æ–π –≤–∞–ª—é—Ç—ã  
- ‚úÖ `switchQuoteCurrency()` - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–µ–ª–µ–∫—Ç–æ—Ä

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç

| –ú–µ—Ç—Ä–∏–∫–∞ | –ë—ã–ª–æ | –°—Ç–∞–ª–æ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|------|-------|-----------|
| –ó–∞–¥–µ—Ä–∂–∫–∏ | 500–º—Å √ó 3 = 1.5—Å | 0–º—Å | **-1.5—Å** |
| –ë–ª–æ–∫–∏—Ä—É—é—â–∏–µ await | 2 —à—Ç | 0 —à—Ç | **100%** |
| –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º | –ß–∞—Å—Ç–∏—á–Ω—ã–π | –ü–æ–ª–Ω—ã–π | **+30%** |
| **–í—Ä–µ–º—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è** | **10-20—Å** | **~1-2—Å** | **üöÄ √ó10 –±—ã—Å—Ç—Ä–µ–µ** |

---

## üîß –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **`static/app.js`**
   - –§—É–Ω–∫—Ü–∏—è `switchBaseCurrency()`
   - –§—É–Ω–∫—Ü–∏—è `changeQuoteCurrency()`
   - –§—É–Ω–∫—Ü–∏—è `switchQuoteCurrency()`

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ö–ª–∏–∫–∞–π—Ç–µ –ø–æ –≤–∫–ª–∞–¥–∫–∞–º –≤–∞–ª—é—Ç (BTC, ETH, ADA, XRP...)
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - ‚ö° –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—á—Ç–∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ (1-2 —Å–µ–∫—É–Ω–¥—ã)
   - üé® –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫–µ (—Å–∏–Ω—è—è –ø–æ–ª–æ—Å–∫–∞)
   - üìä –í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
   - üîÑ –ù–µ—Ç "–∑–∞–ª–∏–ø–∞–Ω–∏–π" –∏ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π

---

## üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ú–µ—Ö–∞–Ω–∏–∑–º –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∫–ª–∏–∫–æ–≤
```javascript
let isSwitchingCurrency = false;
let pendingSwitchCurrency = null;

// –ü—Ä–∏ –∫–ª–∏–∫–µ:
if (isSwitchingCurrency) {
  pendingSwitchCurrency = requestedCurrency; // –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø—Ä–æ—Å
  return;
}

// –í finally –±–ª–æ–∫–µ:
if (pendingSwitchCurrency && pendingSwitchCurrency !== currentBaseCurrency) {
  setTimeout(() => switchBaseCurrency(pendingSwitchCurrency), 0);
}
```

### –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
```javascript
await Promise.all([
  loadMarketData(true),        // –¶–µ–Ω–∞, –æ–±—ä—ë–º, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞ 24—á
  loadPairBalances(),           // –ë–∞–ª–∞–Ω—Å—ã base/quote –≤–∞–ª—é—Ç
  loadPairParams(true),         // –¢–æ—á–Ω–æ—Å—Ç—å —Ü–µ–Ω—ã/–∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
  loadTradeParams(),            // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–æ—Ä–≥–æ–≤–ª–∏
  loadBreakEvenTable(),         // –¢–∞–±–ª–∏—Ü–∞ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏
  updateSessionProfit(),        // –ü—Ä–∏–±—ã–ª—å —Å–µ—Å—Å–∏–∏
  UIStateManager.savePartial()  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞ –≤–∞–ª—é—Ç—ã
]);
```

---

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∞–ª—é—Ç —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç **–≤ 10 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ** –±–ª–∞–≥–æ–¥–∞—Ä—è:
- ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–¥–µ—Ä–∂–µ–∫
- ‚úÖ –ü–æ–ª–Ω–æ–π –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–µ–π –ø–æ–¥–ø–∏—Å–∫–µ –Ω–∞ WebSocket
- ‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—é UI state

**–í—Ä–µ–º—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è: ~1-2 —Å–µ–∫—É–Ω–¥—ã** ‚ö°

---

**–ê–≤—Ç–æ—Ä:** GitHub Copilot  
**–í–µ—Ä—Å–∏—è:** 2.0 (–§–∏–Ω–∞–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è)
