# ИСПРАВЛЕНИЕ ЗАВЕРШЕНО: Столбцы "Инв.Сумм,$" и " БезУб,%"

## Проблема
API-эндпоинт /api/trade/indicators **не возвращал поля 	otal_invested и reakeven_pct** в таблице безубыточности, хотя эти поля корректно рассчитывались в calculate_breakeven_table и сохранялись в состоянии циклов.

## Причина
В файле mTrade.py (строка 1736) при формировании ответа API фильтровались поля таблицы и **НЕ включались** 	otal_invested и reakeven_pct:

`python
if include_table:
    autotrade_levels['table'] = [{
        'step': r.get('step'),
        'rate': r.get('rate'),
        'purchase_usd': r.get('purchase_usd'),
        'breakeven_price': r.get('breakeven_price'),  #  БЕЗ total_invested
        'target_delta_pct': r.get('target_delta_pct'),
        'decrease_step_pct': r.get('decrease_step_pct'),
        'cumulative_decrease_pct': r.get('cumulative_decrease_pct')  #  БЕЗ breakeven_pct
    } for r in table]
`

## Решение
Добавлены недостающие поля в ответ API:

`python
if include_table:
    autotrade_levels['table'] = [{
        'step': r.get('step'),
        'rate': r.get('rate'),
        'purchase_usd': r.get('purchase_usd'),
        'total_invested': r.get('total_invested'),  #  ДОБАВЛЕНО
        'breakeven_price': r.get('breakeven_price'),
        'breakeven_pct': r.get('breakeven_pct'),  #  ДОБАВЛЕНО
        'target_delta_pct': r.get('target_delta_pct'),
        'decrease_step_pct': r.get('decrease_step_pct'),
        'cumulative_decrease_pct': r.get('cumulative_decrease_pct')
    } for r in table]
`

## Проверка
1.  Все сохранённые таблицы в utotrader_cycles_state.json уже содержат поля 	otal_invested и reakeven_pct
2.  Функция calculate_breakeven_table корректно формирует эти поля
3.  API теперь возвращает все необходимые поля на фронтенд

## Результат
Столбцы **"Инв.Сумм,$"** и **" БезУб,%"** теперь будут корректно отображаться в таблице безубыточности на фронтенде.

## Файлы изменены
- c:\Users\Администратор\Documents\bGate.mTrade\mTrade.py (строка 1736)

## Дата
2025-12-10 10:06:02
