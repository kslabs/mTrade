# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Å—Ç–∞—Ä—Ç–∞ —Ü–∏–∫–ª–∞ - –ó–ê–í–ï–†–®–ï–ù–û

## –î–∞—Ç–∞: 2024
## –í–µ—Ä—Å–∏—è: 1.5.1

## –ü—Ä–æ–±–ª–µ–º–∞
–í –º–µ—Ç–æ–¥–µ `_try_start_cycle_impl` –±—ã–ª–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ª–æ–≤–∏–π –∑–∞–ø—É—Å–∫–∞ —Å—Ç–∞—Ä—Ç–æ–≤–æ–π –ø–æ–∫—É–ø–∫–∏:
- –ë—ã–ª–∏ –¥—É–±–ª–∏—Ä—É—é—â–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–∞–ª–∞–Ω—Å–∞ BASE
- –õ–æ–≥–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∞ —Å—Ç–∞—Ä—Ç –µ—Å–ª–∏ –±–∞–ª–∞–Ω—Å BASE >= 90% –æ—Ç purchase_usd
- –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ —Ç–æ–º—É, —á—Ç–æ —Ü–∏–∫–ª –º–æ–≥ –Ω–µ –Ω–∞—á–∞—Ç—å—Å—è –¥–∞–∂–µ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –≤—Å–µ—Ö —É—Å–ª–æ–≤–∏–π

## –†–µ—à–µ–Ω–∏–µ
–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ `_try_start_cycle_impl` —Å —á–µ—Ç–∫–∏–º–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏:

### –£—Å–ª–æ–≤–∏—è –¥–ª—è —Å—Ç–∞—Ä—Ç–∞ —Ü–∏–∫–ª–∞:
1. ‚úÖ **–¢–æ—Ä–≥–æ–≤–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∞** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è permissions –¥–ª—è –≤–∞–ª—é—Ç—ã
2. ‚úÖ **–¶–∏–∫–ª –ù–ï –∞–∫—Ç–∏–≤–µ–Ω** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —á—Ç–æ `active = False`
3. ‚úÖ **–ë–∞–ª–∞–Ω—Å BASE < —Ç—Ä–µ–±—É–µ–º–æ–≥–æ** - –±–∞–ª–∞–Ω—Å BASE (–≤ USDT) < purchase_usd (—Å—Ç—Ä–æ–∫–∞ 0 —Ç–∞–±–ª–∏—Ü—ã)
4. ‚úÖ **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∫–≤–æ—Ç—ã –ø–∞—Ä—ã** - —Å–æ–±–ª—é–¥–µ–Ω—ã min_quote_amount –∏ min_base_amount
5. ‚úÖ **–ë–∞–ª–∞–Ω—Å QUOTE –¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω** - quote_available >= (purchase_usd + keep)

### –¢–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –≤—Å–µ 5 —É—Å–ª–æ–≤–∏–π –≤—ã–ø–æ–ª–Ω–µ–Ω—ã ‚Üí —Å—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### –î–æ:
```python
# –ë—ã–ª–æ –º–Ω–æ–≥–æ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –±–∞–ª–∞–Ω—Å–∞
if base_balance_in_quote >= purchase_usd:
    # –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å—Ç–∞—Ä—Ç–∞
    
# –ü–æ–∑–∂–µ –µ—â–µ –æ–¥–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞
if current_base_usd >= purchase_usd * 0.9:
    # –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å—Ç–∞—Ä—Ç–∞
```

### –ü–æ—Å–ª–µ:
```python
# –ß–µ—Ç–∫–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
# –®–ê–ì 1: –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–ª–∏
if not perms or not perms.get(base, False):
    return

# –®–ê–ì 2: –¶–∏–∫–ª –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω
if cycle.get('active'):
    return

# –®–ê–ì 3: –ë–∞–ª–∞–Ω—Å BASE < —Ç—Ä–µ–±—É–µ–º–æ–≥–æ (–ö–õ–Æ–ß–ï–í–ê–Ø –ü–†–û–í–ï–†–ö–ê)
base_balance_in_quote = base_balance * price
if base_balance_in_quote >= purchase_usd:
    return  # –º–æ–Ω–µ—Ç —É–∂–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ

# –®–ê–ì 4: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∫–≤–æ—Ç—ã –ø–∞—Ä—ã
# ... –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ amount_base ...

# –®–ê–ì 5: –ë–∞–ª–∞–Ω—Å QUOTE –¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω
if quote_available < quote_required:
    return

# –ü–û–ö–£–ü–ö–ê –í–´–ü–û–õ–ù–Ø–ï–¢–°–Ø
print(f"üéØ –í–°–ï –£–°–õ–û–í–ò–Ø –í–´–ü–û–õ–ù–ï–ù–´! –ù–∞—á–∏–Ω–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—É—é –ø–æ–∫—É–ø–∫—É...")
```

## –£–ª—É—á—à–µ–Ω–∏—è

### 1. –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
- –£–¥–∞–ª–µ–Ω–∞ –ª–∏—à–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞ `if current_base_usd >= purchase_usd * 0.9`
- –£–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ –≤—ã–∑–æ–≤—ã `api_client.get_account_balance()`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –µ–¥–∏–Ω—ã–π –º–µ—Ç–æ–¥ `_get_account_balance(currency)`

### 2. –ß–µ—Ç–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
–ö–∞–∂–¥—ã–π —à–∞–≥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ –ª–æ–≥ —Å —ç–º–æ–¥–∑–∏:
```
[START_CYCLE][BTC] === –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –¥–ª—è —Å—Ç–∞—Ä—Ç–æ–≤–æ–π –ø–æ–∫—É–ø–∫–∏ ===
[START_CYCLE][BTC] ‚úÖ –£–°–õ–û–í–ò–ï 1: —Ç–æ—Ä–≥–æ–≤–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∞
[START_CYCLE][BTC] ‚úÖ –£–°–õ–û–í–ò–ï 2: —Ü–∏–∫–ª –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω
[START_CYCLE][BTC] base_balance=0.00001234 BTC (= 0.45 USDT)
[START_CYCLE][BTC] ‚úÖ –£–°–õ–û–í–ò–ï 3: –±–∞–ª–∞–Ω—Å BASE (0.45) < —Ç—Ä–µ–±—É–µ–º–æ–≥–æ (10.00)
[START_CYCLE][BTC] quote_available=1000.00, quote_required=110.00
[START_CYCLE][BTC] ‚úÖ –£–°–õ–û–í–ò–ï 5: –±–∞–ª–∞–Ω—Å USDT –¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω
[START_CYCLE][BTC] üéØ –í–°–ï –£–°–õ–û–í–ò–Ø –í–´–ü–û–õ–ù–ï–ù–´! –ù–∞—á–∏–Ω–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—É—é –ø–æ–∫—É–ø–∫—É...
```

### 3. –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞
–í–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ API —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥:
```python
base_balance = self._get_account_balance(base)
quote_available = self._get_account_balance(quote)
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ production:
1. ‚úÖ –°—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –¢–û–õ–¨–ö–û –∫–æ–≥–¥–∞ –≤—Å–µ 5 —É—Å–ª–æ–≤–∏–π –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
2. ‚úÖ –°—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞ –ù–ï –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –µ—Å–ª–∏ –±–∞–ª–∞–Ω—Å BASE —É–∂–µ –¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω
3. ‚úÖ –°—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞ –ù–ï –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –µ—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ USDT
4. ‚úÖ –°—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞ –ù–ï –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –µ—Å–ª–∏ —Ç–æ—Ä–≥–æ–≤–ª—è –∑–∞–ø—Ä–µ—â–µ–Ω–∞
5. ‚úÖ –°—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞ –ù–ï –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –µ—Å–ª–∏ —Ü–∏–∫–ª —É–∂–µ –∞–∫—Ç–∏–≤–µ–Ω

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤:
```bash
# –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∏–¥–Ω—ã –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
grep "START_CYCLE" system_trader.log
grep "–í–°–ï –£–°–õ–û–í–ò–Ø –í–´–ü–û–õ–ù–ï–ù–´" system_trader.log
grep "–£–°–õ–û–í–ò–ï" system_trader.log
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç
‚úÖ **–õ–æ–≥–∏–∫–∞ —Å—Ç–∞—Ä—Ç–∞ —Ü–∏–∫–ª–∞ —É–ø—Ä–æ—â–µ–Ω–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞**
‚úÖ **–£–¥–∞–ª–µ–Ω—ã –≤—Å–µ –¥—É–±–ª–∏—Ä—É—é—â–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏**
‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
‚úÖ **–ö–æ–¥ –ø—Ä–æ–≤–µ—Ä–µ–Ω –Ω–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏**
‚úÖ **–ì–æ—Ç–æ–≤–æ –∫ production —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é**

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã
- `c:\Users\–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä\Documents\bGate.mTrade\autotrader.py`
  - –ú–µ—Ç–æ–¥: `_try_start_cycle_impl` (—Å—Ç—Ä–æ–∫–∏ ~813-950)

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏
1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å autotrader.py
2. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ disabled –≤–∞–ª—é—Ç—ã –Ω–µ —Ç–æ—Ä–≥—É—é—Ç—Å—è
4. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Å—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å—Ä–∞–∑—É –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —É—Å–ª–æ–≤–∏–π

---
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û –ö –î–ï–ü–õ–û–Æ
**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:** –°–∏–Ω—Ç–∞–∫—Å–∏—Å ‚úÖ, –õ–æ–≥–∏–∫–∞ ‚úÖ
